#include "bigint_test.h"
#include "../lib/bigint.h"
#include "test_util.h"
#include <valgrind/memcheck.h>
#include <assert.h>
#include <stdlib.h>

int bigint_expand_test() {
    int failed = 0;
    bigint a;
    bigint_init(&a, 5); // Initialize bigint with 5 digits

    // Set some values
    for (int i = 0; i < 5; ++i) {
        a.digits[i] = i;
    }

    // Expand the bigint
    bigint_err result = bigint_expand(&a, 10);

    // Test the results
    assert(result == BIGINT_OKAY); // Check if expansion was successful
    assert(a.num_of_digit == 10);  // Check if size is updated correctly

    // Check if the original values are still intact
    for (int i = 0; i < 5; ++i) {
        assert(a.digits[i] == (uint64_t)i); 
    }

    // Check if the new digits are initialized to zero (or as per your implementation)
    for (int i = 5; i < 10; ++i) {
        assert(a.digits[i] == 0);
    }

    // Cleanup
    bigint_free(&a);
    print_passed("test_bigint_expand passed");
    return failed;
}

int bigint_clamp_test() {
    int failed = 0;
    bigint a;
    // Test with a non-zero bigint
    bigint_init(&a, 10); // Initialize bigint with 10 digits, MSD at 5
    for(int i = 0; i < 6; i++){
        a.digits[i] = 1;
    }
    a.MSD = 5;
    bigint_clamp(&a);
    assert(a.MSD == 5); // MSD should remain 5 after clamping
    bigint_free(&a);

    // Test with a bigint that should be clamped
    bigint_init(&a, 10); // Initialize bigint with unnecessary trailing zeros
    a.digits[7] = 0; a.digits[8] = 0; a.digits[9] = 0; // Zeroes after 7th digit
    for(int i = 0; i < 7; i++){
        a.digits[i] = 1;
    }
    a.MSD = 9;
    bigint_clamp(&a);
    assert(a.MSD == 6); // MSD should be updated to 6
    bigint_free(&a);

    // Test with a bigint that is all zeroes
    bigint_init(&a, 10);
    for (unsigned int i = 0; i < 10; i++) {
        a.digits[i] = 0; // All digits are zero
    }
    a.MSD = 9;
    bigint_clamp(&a);
    assert(a.MSD == 0); // MSD should be updated to 0
    bigint_free(&a);
    print_passed("All bigint_clamp tests passed");
    return failed;
}

int bigint_set_zero_test(){
    int failed = 0;

    bigint b;

    // Initialize bigint with a specific value, e.g., 123
    bigint_init(&b, 3); 
    b.digits[0] = 3;
    b.digits[1] = 2;
    b.digits[2] = 1;
    b.MSD = 2; // Since we manually set the number to 123

    // Perform the left shift operation
    assert(bigint_set_zero(&b) == BIGINT_OKAY);
    assert(b.digits[0] == 0); 
    assert(b.MSD == 0);

    // Clean up
    bigint_free(&b);
    print_passed("bigint_set_zero test passed");

    return failed;
}

int bigint_left_shift_test(){
    int failed = 0;
    bigint b, r;
    bigint_err err;

    bigint_init(&b, 3); 
    bigint_init(&r, 6); 

    unsigned char b1[] = {
        0x01, 0x01, 0x01, 0x01, 0x02, 0x02, 0x02, 0x02,
        0x03, 0x03, 0x03, 0x03
    };

    unsigned char r1[] = {
        0x01, 0x01, 0x01, 0x01, 0x02, 0x02, 0x02, 0x02,
        0x03, 0x03, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };

    bigint_from_bytes(&b, b1, 12);
    bigint_from_bytes(&r, r1, 24);

    err = bigint_left_shift_digits(&b, 3);
    assert(err == BIGINT_OKAY);

    int res = bigint_cmp(&b, &r);
    if(res == 0){
        bigint_print(&b, "b = ");
        print_passed("bigint_left_shift_test passed");
    } else{
        bigint_print(&b, "b = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_left_shift_test failed");
        failed = 1;
    }

    // Clean up
    bigint_free(&b);
    bigint_free(&r);
    return failed;
}

int bigint_right_shift_test(){
    int failed = 0;

    bigint b, r;
    bigint_init(&r, 4);
    bigint_init(&b, 4); 
    unsigned char b1[] = {
        0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x02,
        0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x04
    };
    unsigned char exp_res[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,
        0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x03
    };

    bigint_from_bytes(&b, b1, 16);
    bigint_from_bytes(&r, exp_res, 16);

    bigint_err err = bigint_right_shift(&b);
    assert(err == BIGINT_OKAY);

    int res = bigint_cmp(&b, &r);
    if(res == 0){
        print_passed("bigint_right_shift_test passed");
    } else {
        failed = 1;
        bigint_print(&b, "b = ");
        print_failed("bigint_right_shift_test failed");
    }

    // Clean up
    bigint_free(&b);
    bigint_free(&r);
    return failed;
}

int bigint_from_to_bytes_test() {
    int failed = 0;
    unsigned char original_bytes[] = {0xDE, 0xAD, 0xBE, 0xEF, 0x00, 0x00, 0x01, 0x23};
    size_t original_size = sizeof(original_bytes) / sizeof(original_bytes[0]);

    bigint b;
    bigint_init(&b, 10); // Initialize bigint with more digits than necessary for test

    // Convert byte array to bigint
    bigint_err from_result = bigint_from_bytes(&b, original_bytes, original_size);
    if (from_result != BIGINT_OKAY) {
        print_msg_n(RED, "[:(   ] ");
        printf("bigint_from_bytes failed with error code: %d\n", from_result);
        failed = 1;
        return failed;
    }

    // Allocate buffer for conversion back to bytes
    unsigned char* converted_bytes = malloc(original_size);
    if (!converted_bytes) {
        print_msg_n(RED, "[:(   ] ");
        printf("Memory allocation failed for converted_bytes\n");
        failed = 1;
        return failed;
    }

    // Convert bigint back to byte array
    bigint_err to_result = bigint_to_bytes(&b, converted_bytes, original_size, 1); // Assuming ignore_leading_zero is a flag
    if (to_result != BIGINT_OKAY) {
        print_msg_n(RED, "[:(   ] ");
        printf("bigint_to_bytes failed with error code: %d\n", to_result);
        free(converted_bytes);
        failed = 1;
        return failed;
    }

    // Compare original and converted byte arrays
    if (memcmp(original_bytes, converted_bytes, original_size) == 0) {
        print_bytes(converted_bytes, original_size, "converted_bytes: ");
        print_passed("Test PASSED: Conversion from and to bytes is consistent");
    } else {
        print_bytes(original_bytes, original_size, "original_bytes: ");
        print_bytes(converted_bytes, original_size, "converted_bytes: ");
        print_failed("Test FAILED: Original and converted bytes do not match");
        failed = 1;
    }
    free(converted_bytes);

    unsigned char data2[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                            0xDE, 0xAD, 0xBE, 0xEF, 0x00, 0x00, 0x01, 0x23};
    original_size = sizeof(data2) / sizeof(data2[0]);
    from_result = bigint_from_bytes(&b, data2, original_size);
    if (from_result != BIGINT_OKAY) {
        print_msg_n(RED, "[:(   ] ");
        printf("bigint_from_bytes failed with error code: %d\n", from_result);
        failed = 1;
        return failed;
    }
    // Allocate buffer for conversion back to bytes
    unsigned char* converted_bytes1 = malloc(original_size);
    if (!converted_bytes1) {
        print_msg_n(RED, "[:(   ] ");
        printf("Memory allocation failed for converted_bytes\n");
        failed = 1;
        return failed;
    }
    to_result = bigint_to_bytes(&b, converted_bytes1, original_size, 0); // Assuming ignore_leading_zero is a flag
    if (to_result != BIGINT_OKAY) {
        print_msg_n(RED, "[:(   ] ");
        printf("bigint_to_bytes failed with error code: %d\n", to_result);
        free(converted_bytes1);
        failed = 1;
        return failed;
    }
    // Compare original and converted byte arrays
    if (memcmp(data2, converted_bytes1, original_size) == 0) {
        print_bytes(converted_bytes1, original_size, "converted_bytes: ");
        print_passed("Test PASSED: Conversion from and to bytes is consistent");
        // print_msg_n(GREEN, "[   OK] ");
        // print_msg(GREEN, "Test PASSED: Conversion from and to bytes is consistent.\n");
    } else {
        print_bytes(data2, original_size , "original_bytes: ");
        print_bytes(converted_bytes1, original_size, "converted_bytes: ");
        print_failed("Test FAILED: Original and converted bytes do not match");
        // print_msg_n(RED, "[:(   ] ");
        // print_msg(RED, "Test FAILED: Original and converted bytes do not match.\n");
        failed = 1;
    }
    free(converted_bytes1);

    unsigned char* converted_bytes2 = malloc(original_size);
    if (!converted_bytes2) {
        printf("Memory allocation failed for converted_bytes\n");
        failed = 1;
        return failed;
    }
    to_result = bigint_to_bytes(&b, converted_bytes2, original_size, 1); // Assuming ignore_leading_zero is a flag
    if (to_result != BIGINT_OKAY) {
        printf("bigint_to_bytes failed with error code: %d\n", to_result);
        free(converted_bytes2);
        failed = 1;
        return failed;
    }
    // Compare original and converted byte arrays
    if (memcmp(data2, converted_bytes2, original_size) == 0) {
        print_bytes(converted_bytes2, original_size, "converted_bytes: ");
        print_passed("Test PASSED: Conversion from and to bytes is consistent");
        // print_msg(GREEN, "Test PASSED: Conversion from and to bytes is consistent.\n");
    } else {
        print_bytes(data2, original_size, "original_bytes: ");
        print_bytes(converted_bytes2, original_size, "converted_bytes: ");
        print_failed("Test FAILED: Original and converted bytes do not match");
        // print_msg(RED, "Test FAILED: Original and converted bytes do not match.\n");
        failed = 1;
    }
    free(converted_bytes2);
    bigint_free(&b);
    return failed;
}

int bigint_pad_zero_test(){
    int failed = 0;

    unsigned char a1[] = {
        0x10, 0x20, 0x30, 0x40
    };

    bigint a;
    bigint_init(&a, 1);
    bigint_from_bytes(&a, a1, 4);
    bigint_pad_zero(&a, 4);
    bigint_print(&a, "a = ");

    if(a.MSD != 4){
        print_failed("a.MSD should be 4");
        failed = 1;
    }

    int check = 0;
    for(int i = 1; i < 5; i++){
        if(a.digits[i] != 0){
            check = 1;
        }
    }
    if(!check){
        print_passed("bigint_pad_zero_test passed");
    } else {
        print_failed("bigint_pad_zero_test failed");
        failed = 1;
    }

    bigint_free(&a);
    return failed;
}

int bigint_cmp_zero_test(){
    int failed = 0;
    int res = 0;
    bigint a;
    bigint_init(&a, 1);
    bigint_from_small_int(&a, 2);
    res = bigint_cmp_zero(&a);
    if(res){
        print_passed("bigint_cmp_zero_test - small bigint passed");
    } else{
        print_failed("bigint_cmp_zero_test - small bigint failed");
        failed = 1;
    }

    res = 0;
    unsigned char data1[] = {0xFF, 0xFF, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 
                            0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06};
    bigint_from_bytes(&a, data1, 16);
    res = bigint_cmp_zero(&a);
    if(res){
        print_passed("bigint_cmp_zero_test - normal bigint passed");
    } else{
        print_failed("bigint_cmp_zero_test - normal bigint failed");
        failed = 1;
    }

    res = 0;
    unsigned char data2[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
                            0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06};
    bigint_from_bytes(&a, data2, 16);
    res = bigint_cmp_zero(&a);
    if(res){
        print_passed("bigint_cmp_zero_test - leading zero bigint passed");
    } else{
        print_failed("bigint_cmp_zero_test - leading zero bigint failed");
        failed = 1;
    }

    res = 0;
    unsigned char data3[] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};
    bigint_from_bytes(&a, data3, 8);
    res = bigint_cmp_zero(&a);
    if(!res){
        print_passed("bigint_cmp_zero_test - zero passed");
    } else{
        print_failed("bigint_cmp_zero_test - zero failed");
        failed = 1;
    }
    bigint_free(&a);
    return failed;
}

int bigint_cmp_test(){
    int failed = 0;
    int res = 0;
    bigint a;
    bigint b;
    bigint_init(&a, 1);
    bigint_init(&b, 1);
    bigint_from_small_int(&a, 2);
    bigint_from_small_int(&b, 2);
    res = bigint_cmp(&a, &b);
    if(!res){
        print_passed("bigint_cmp_test - same small bigint passed");
    } else{
        print_failed("bigint_cmp_test - same small bigint failed");
        failed = 1;
    }

    bigint_from_small_int(&a, 2);
    bigint_from_small_int(&b, 3);
    res = bigint_cmp(&a, &b);
    if(res == -1){
        print_passed("bigint_cmp_test - different small bigint passed");
    } else{
        print_failed("bigint_cmp_test - different small bigint failed");
        failed = 1;
    }

    res = 0;
    unsigned char data1[] = {0xFF, 0xFF, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 
                            0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06};
    unsigned char datab[] = {0xFF, 0xFF, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 
                            0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06};
    bigint_from_bytes(&a, data1, 16);
    bigint_from_bytes(&b, datab, 16);
    res = bigint_cmp(&a, &b);
    if(res == 0){
        print_passed("bigint_cmp_test -  same normal bigint passed");
    } else{
        print_failed("bigint_cmp_test -  same normal bigint failed");
        failed = 1;
    }

    res = 0;
    unsigned char data2[] = {0xFE, 0xFF, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 
                            0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06};
    unsigned char datab2[] = {0xFF, 0xFF, 0x01, 0x02, 0x03, 0x04, 0x05, 
                            0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06};
    bigint_from_bytes(&a, data2, 16);
    bigint_from_bytes(&b, datab2, 15);
    res = bigint_cmp(&a, &b);
    if(res){
        print_passed("bigint_cmp_test -  same normal bigint passed");
    } else{
        print_failed("bigint_cmp_test -  same normal bigint failed");
        failed = 1;
    }

    res = 0;
    unsigned char data3[] = {0xC3, 0x1F, 0x98, 0xAC, 0x19, 0xAB, 0xB1, 0xC5, 
                            0xFB, 0xA1, 0x00, 0x9D, 0xEF, 0xEE, 0x12, 0x96};
    bigint_from_bytes(&a, data3, 16);
    bigint_from_small_int(&b, 0);
    res = bigint_cmp(&a, &b);
    if(res == 1){
        print_passed("bigint_cmp_test -  python generated random bigint passed");
    } else{
        print_failed("bigint_cmp_test -  python generated random bigint failed");
        failed = 1;
    }

    res = 0;
    bigint_free(&a);
    bigint_free(&b);
    bigint_init(&a, 1);
    bigint_init(&b, 1);
    unsigned char data4[] = {0xC3, 0x1F, 0x98, 0xAC, 0x19, 0xAB, 0xB1, 0xC5, 
                            0xFB, 0xA1, 0x00, 0x9D, 0xEF, 0xEE, 0x12, 0x96};
    unsigned char datab4[] = {0xFF, 0xFF, 0x01, 0x02, 0x03, 0x04, 0x05, 0x00,
                            0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06};
    bigint_from_bytes(&a, data4, 16);
    bigint_from_bytes(&b, datab4, 16);
    res = bigint_cmp(&a, &b);
    if(res == -1){
        print_passed("bigint_cmp_test -  python generated random bigint 2 passed");
    } else{
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        print_failed("bigint_cmp_test -  python generated random bigint 2 failed");
        printf("res = %d\n", res);
        failed = 1;
    }

    unsigned char data5[] = {
        0xC3, 0x1F, 0x98, 0xAC, 0x19, 0xAB, 0xB1, 0xC5, 
        0xFB, 0xA1, 0x00, 0x9D, 0xEF, 0xEE, 0x12, 0x96
    };

    unsigned char datab5[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };
    
    bigint_from_bytes(&a, data5, 16);

    bigint_from_bytes(&b, datab5, 16);
    res = bigint_cmp(&a, &b);
    if(res == 1){
        print_passed("bigint_cmp_test -  leading zeros passed");
    } else{
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        print_failed("bigint_cmp_test -  leading zeros failed");
        failed = 1;
    }

    unsigned char dataa1[] = {0x79, 0xEE, 0x36, 0xD7, 0xBC, 0x26, 0xB3, 0xBC, 
                            0x9A, 0x60, 0x4E, 0x98, 0xEA, 0xEB, 0x7C, 0xBB};
    unsigned char datab1[] = {0x59, 0x25, 0xA9, 0x03, 0x60, 0x40, 0xED, 0x3D};
    bigint_from_bytes(&a, dataa1, 16);
    bigint_from_bytes(&b, datab1, 8);
    res = bigint_cmp(&a, &b);
    if(res == 1){
        print_passed("bigint_cmp_test -  diff length passed");
    } else{
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        print_failed("bigint_cmp_test -  diff length failed");
        failed = 1;
    }

    unsigned char a6[] = {
        0xBC, 0x6A, 0x9F, 0x83, 0x18, 0xA2, 0x8F, 0x23, 
        0x7A, 0x68, 0x28, 0xFA, 0x12, 0x39, 0x55, 0x1C
    };

    unsigned char b6[] = {
        0x30, 0xB7, 0x6C, 0x86, 0x0C, 0xF0, 0x6C, 0x1E, 
        0x17, 0x69, 0x3D, 0xAE, 0x63, 0xD7, 0x11, 0x1C
    };
    bigint_from_bytes(&a, a6, 16);
    bigint_from_bytes(&b, b6, 16);
    res = bigint_cmp(&a, &b);
    if(res == 1){
        print_passed("bigint_cmp_test -  random int passed");
    } else{
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        printf("res = %d\n", res);
        print_failed("bigint_cmp_test -  random int failed");
        failed = 1;
    }

    unsigned char a7[] = {
        0x00, 0x00, 0x00, 0x01, 0x22, 0xC6, 0x4C, 0xC1,
        0xB1, 0x62, 0x93, 0x1F
    };

    unsigned char b7[] = {
        0x00, 0x00, 0x00, 0x01, 0x55, 0xC5, 0x0D, 0x99,
        0x78, 0xE1, 0xA2, 0x80
    };

    bigint_from_bytes(&a, a7, 12);
    bigint_from_bytes(&b, b7, 12);
    res = bigint_cmp(&a, &b);
    if(res == -1){
        print_passed("bigint_cmp_test -  random int 2 passed");
    } else{
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        printf("res = %d\n", res);
        print_failed("bigint_cmp_test -  random int 2 failed");
        failed = 1;
    }

    bigint_free(&a);
    bigint_free(&b);

    return failed;
}

int bigint_add_test(){
    int failed = 0;
    // print_msg(YELLOW, "bigint_add_test");
    bigint a, b, c, res;
    bigint_err rv = 0;
    bigint_init(&a, 4);
    bigint_init(&b, 4);
    bigint_init(&c, 4);
    bigint_init(&res, 4);

    unsigned char dataa[] = {
        0x79, 0xEE, 0x36, 0xD7, 0xBC, 0x26, 0xB3, 0xBC, 
        0x9A, 0x60, 0x4E, 0x98, 0xEA, 0xEB, 0x7C, 0xBB
    };
    unsigned char datab[] = {
        0x59, 0x25, 0xA9, 0x03, 0x60, 0x40, 0xED, 0x3D, 
        0xCE, 0x91, 0xD2, 0xBB, 0x8B, 0x95, 0x1C, 0xE7
    };
    const unsigned char exp_res[] = {
        0xD3, 0x13, 0xDF, 0xDB, 0x1C, 0x67, 0xA0, 0xFA, 
        0x68, 0xF2, 0x21, 0x54, 0x76, 0x80, 0x99, 0xA2
    };

    bigint_from_bytes(&a, dataa, 16);
    bigint_from_bytes(&b, datab, 16);
    bigint_from_bytes(&res, exp_res, 16);

    rv = bigint_add(&a, &b, &c);
    if(rv != BIGINT_OKAY){
        print_failed("bigint_add failed - encountered an error");
        bigint_free(&a);
        bigint_free(&b);
        bigint_free(&c);
        bigint_free(&res);
        failed = 1;
        return failed;
    }
    unsigned char c_bytes[16];
    int r = bigint_cmp(&c, &res);
    if(!r){
        bigint_print(&c, "c = ");
        print_passed("bigint_add_test - python generated random bigint passed");
    }
    else {
        bigint_print(&c, "c = ");
        bigint_print(&res, "r = ");
        print_failed("bigint_add_test - python generated random bigint failed");
        failed = 1;
    }

    bigint_set_zero(&c);
    bigint_from_small_int(&b, 1);
    bigint_add(&a, &b, &c);

    const unsigned char exp_res1[] = {0x79, 0xEE, 0x36, 0xD7, 0xBC, 0x26, 0xB3, 0xBC, 
                                    0x9A, 0x60, 0x4E, 0x98, 0xEA, 0xEB, 0x7C, 0xBC};
    bigint_from_bytes(&res, exp_res1, 16);
    r = bigint_cmp(&c, &res);
    if(!r){
        bigint_print(&c, "c = ");
        print_passed("bigint_add_test - python generated random bigint 2 passed");
    }
    else {
        bigint_to_bytes(&c, c_bytes, 16, 1);
        print_bytes(c_bytes, 16, "c = ");
        print_bytes(exp_res1, 16, "expected output: ");
        print_failed("bigint_add_test - python generated random bigint 2 failed");
        failed = 1;
    }

    unsigned char a1[] = {
        0x39, 0xA8, 0x98, 0x83, 0xBD, 0x1F, 0x15, 0xD7,
        0xD9, 0x93, 0xCE, 0xF9, 0x19, 0xEA, 0xE8, 0xD1
    };
    unsigned char b1[] = {
        0xBB, 0x98, 0xAC, 0xAF, 0xE6, 0xB2, 0x99, 0xA3,
        0x7F, 0xFC, 0xF5, 0x51, 0x6F, 0xB9, 0x5B, 0xE5,
        0x75, 0x63, 0x3D, 0x09, 0xC6, 0x75, 0x99, 0x7B,
        0x58, 0x9E, 0xA6, 0x42, 0xE5, 0xD6, 0x54, 0x15
    };

    unsigned char exp_res2[] = {
        0xBB, 0x98, 0xAC, 0xAF, 0xE6, 0xB2, 0x99, 0xA3,
        0x7F, 0xFC, 0xF5, 0x51, 0x6F, 0xB9, 0x5B, 0xE5,
        0xAF, 0x0B, 0xD5, 0x8D, 0x83, 0x94, 0xAF, 0x53,
        0x32, 0x32, 0x75, 0x3B, 0xFF, 0xC1, 0x3C, 0xE6
    };

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&b, b1, 32);
    bigint_from_bytes(&res, exp_res2, 32);

    bigint_set_zero(&c);
    bigint_add(&a, &b, &c);
    r = bigint_cmp(&c, &res);
    if(!r){
        bigint_print(&c, "c = ");
        print_passed("bigint_add_test - python generated random bigint 3 passed");
    }
    else {
        bigint_print(&c, "c = ");
        bigint_print(&res, "r = ");
        print_failed("bigint_add_test - python generated random bigint 3 failed");
        failed = 1;
    }

    unsigned char a2[] = {
        0xFB, 0x37, 0xBD, 0x55, 0x08, 0x9A, 0x80, 0xED, 
        0x0F, 0xCF, 0x0F, 0xFD, 0x44, 0x84, 0x19, 0xA3
    };

    unsigned char b2[] = {
        0x40, 0xC2, 0x0B, 0x0A, 0xC2, 0xD3, 0xEA, 0x8D, 
        0xFA, 0x31, 0xD1, 0xD9, 0xEE, 0xDA, 0x11, 0x4C
    };

    unsigned char c2[] = {
        0x01, 0x3B, 0xF9, 0xC8, 0x5F, 0xCB, 0x6E, 0x6B, 
        0x7B, 0x0A, 0x00, 0xE1, 0xD7, 0x33, 0x5E, 0x2A, 
        0xEF
    };

    bigint_free(&c);
    bigint_init(&c, 1);
    bigint_from_bytes(&a, a2, 16);
    bigint_from_bytes(&b, b2, 16);
    bigint_from_bytes(&res, c2, 17);
    bigint_set_zero(&c);
    bigint_add(&a, &b, &c);
    r = bigint_cmp(&c, &res);
    if(!r){
        bigint_print(&c, "c = ");
        print_passed("bigint_add_test - python generated random bigint 4 passed");
    }
    else {
        bigint_print(&res, "r = ");
        bigint_print(&c, "c = ");
        print_failed("bigint_add_test - python generated random bigint 4 failed");
        failed = 1;
    }

    bigint_free(&c);

    bigint_from_bytes(&a, a1, 16);
    bigint_set_zero(&b);
    bigint_init(&c, 1);
    
    bigint_add(&a, &b, &c);
    r = bigint_cmp(&a, &c);
    if(!r){
        bigint_print(&c, "c = ");
        print_passed("bigint_add_test - python generated random bigint add 0 passed");
    }
    else {
        bigint_print(&c, "c = ");
        bigint_print(&a, "r = ");
        print_failed("bigint_add_test - python generated random bigint add 0 failed");
        failed = 1;
    }

    unsigned char a3[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0xFB, 0x37, 0xBD, 0x55, 0x08, 0x9A, 0x80, 0xED, 
        0x0F, 0xCF, 0x0F, 0xFD, 0x44, 0x84, 0x19, 0xA3
    };
    unsigned char b3[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x40, 0xC2, 0x0B, 0x0A, 0xC2, 0xD3, 0xEA, 0x8D, 
        0xFA, 0x31, 0xD1, 0xD9, 0xEE, 0xDA, 0x11, 0x4C
    };
    unsigned char r3[] = {
        0x01, 0x3B, 0xF9, 0xC8, 0x5F, 0xCB, 0x6E, 0x6B, 
        0x7B, 0x0A, 0x00, 0xE1, 0xD7, 0x33, 0x5E, 0x2A, 
        0xEF
    };
    bigint_from_bytes(&a, a3, 24);
    bigint_from_bytes(&b, b3, 24);
    bigint_from_bytes(&res, r3, 17);
    bigint_add(&a, &b, &c);
    r = bigint_cmp(&res, &c);
    if(!r){
        bigint_print(&c, "c = ");
        print_passed("bigint_add_test - python generated random bigint add leading zero passed");
    }
    else {
        bigint_print(&c, "c = ");
        bigint_print(&a, "r = ");
        print_failed("bigint_add_test - python generated random bigint add leading zero failed");
        failed = 1;
    }

    bigint_free(&a);
    bigint_free(&b);
    bigint_free(&c);
    bigint_free(&res);
    
    return failed;
}

int bigint_inc_test(){
    int failed = 0;

    bigint a,r;
    int res = 0;

    unsigned char a1[] = {
        0x00
    };

    unsigned char r1[] = {
        0x01
    };

    bigint_init(&a, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a1, 1);
    bigint_from_bytes(&r, r1, 1);

    bigint_inc(&a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "a = ");
        print_passed("bigint_inc_test 1 passed");
    } else {
        bigint_print(&a, "a = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_inc_test 1 failed");
        failed = 1;
    }

    unsigned char a2[] = {
        0xFF, 0XFF, 0xFF, 0xFF
    };

    unsigned char r2[] = {
        0x01, 0x00, 0x00, 0x00, 0x00
    };
    bigint_from_bytes(&a, a2, 4);
    bigint_from_bytes(&r, r2, 5);

    bigint_inc(&a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "a = ");
        print_passed("bigint_inc_test 2 passed");
    } else {
        bigint_print(&a, "a = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_inc_test 2 failed");
        failed = 1;
    }

    bigint_free(&a);
    bigint_free(&r);
    return failed;

}

int bigint_add_digit_test(){
    int failed = 0;
    bigint b, c, r;
    int res = 0;

    bigint_init(&b, 1); 
    bigint_init(&c, 1);
    bigint_init(&r, 1);
    unsigned char b1[] = {
        0x39, 0xA8, 0x98, 0x83, 0xBD, 0x1F, 0x15, 0xD7,
        0xD9, 0x93, 0xCE, 0xF9, 0x19, 0xEA, 0xE8, 0xD1
    };

    unsigned char r1[] = {
        0x39, 0xA8, 0x98, 0x83, 0xBD, 0x1F, 0x15, 0xD7,
        0xD9, 0x93, 0xCE, 0xF9, 0x19, 0xEA, 0xE8, 0xD2
    };
    bigint_from_bytes(&b, b1, 16);
    bigint_from_bytes(&r, r1, 16);
    bigint_add_digit(&b, 1, &c);
    res = bigint_cmp(&c, &r);
    if(!res){
        print_passed("bigint_add_digit_test 1 passed");
    } else {
        print_failed("bigint_add_digit_test 1 failed");
        failed = 1;
    }

    bigint_from_small_int(&b, 9999);
    bigint_add_digit(&b, 1, &c);
    bigint_from_small_int(&r, 10000);
    res = bigint_cmp(&c, &r);
    if(!res){
        print_passed("bigint_inc_test 2 passed");
    } else {
        print_failed("bigint_inc_test 2 failed");
        failed = 1;
    }

    bigint_free(&b); 
    bigint_free(&c);
    bigint_free(&r);

    return failed;
}

int bigint_sub_test(){
    int failed = 0;
    bigint a, b, c, res;
    int rv = 0;
    bigint_init(&a, 1);
    bigint_init(&b, 1);
    bigint_init(&c, 1);
    bigint_init(&res, 1);
    unsigned char a1[] = {
        0xBC, 0x6A, 0x9F, 0x83, 0x18, 0xA2, 0x8F, 0x23, 
        0x7A, 0x68, 0x28, 0xFA, 0x12, 0x39, 0x55, 0x1C
    };

    unsigned char b1[] = {
        0x30, 0xB7, 0x6C, 0x86, 0x0C, 0xF0, 0x6C, 0x1E, 
        0x17, 0x69, 0x3D, 0xAE, 0x63, 0xD7, 0x11, 0x1C
    };

    unsigned char exp_res[] = {
        0x8B, 0xB3, 0x32, 0xFD, 0x0B, 0xB2, 0x23, 0x05, 
        0x62, 0xFE, 0xEB, 0x4B, 0xAE, 0x62, 0x44, 0x00
    };

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&b, b1, 16);
    bigint_from_bytes(&res, exp_res, 16);
    bigint_sub(&a, &b, &a);
    rv = bigint_cmp(&a, &res);
    if(!rv){
        bigint_print(&a, "c = ");
        print_passed("bigint_sub_test - python generated random bigint passed");
    } else {
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&res, "r = ");
        print_failed("bigint_sub_test - python generated random bigint failed");
    }

    unsigned char a2[] = {
        0x10, 0xC9, 0xF8, 0x2C, 0x81, 0x64, 0x3E, 0xEB,
        0xBE, 0x7E, 0x74, 0x86, 0xDA, 0x35, 0x64, 0x4D,
        0x95, 0x12, 0xA1, 0xA8, 0xF8, 0xA6, 0xFA, 0xE6,
        0xC5, 0x52, 0xC7, 0x48, 0x6B, 0x9C, 0x70, 0xAD
    };

    unsigned char b2[] = {
        0x79, 0x21, 0x8E, 0x52, 0x39, 0x80, 0xC3, 0xC2,
        0xB9, 0x7F, 0x37, 0xE8, 0xC1, 0xDE, 0x36, 0x0A
    };

    unsigned char exp_res2[] = {
        0x10, 0xC9, 0xF8, 0x2C, 0x81, 0x64, 0x3E, 0xEB,
        0xBE, 0x7E, 0x74, 0x86, 0xDA, 0x35, 0x64, 0x4D,
        0x1B, 0xF1, 0x13, 0x56, 0xBF, 0x26, 0x37, 0x24,
        0x0B, 0xD3, 0x8F, 0x5F, 0xA9, 0xBE, 0x3A, 0xA3
    };
    bigint_free(&c);

    bigint_init(&c, 1);
    bigint_from_bytes(&a, a2, 32);
    bigint_from_bytes(&b, b2, 16);
    bigint_from_bytes(&res, exp_res2, 32);
    bigint_sub(&a, &b, &a);

    rv = bigint_cmp(&a, &res);
    if(!rv){
        bigint_print(&a, "c = ");
        print_passed("bigint_sub_test - random bigint with different size passed");
    } else {
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&res, "r = ");
        print_failed("bigint_sub_test - random bigint with different size failed");
    }

    unsigned char a3[] = {
        0x01, 0x7A, 0x2F, 0x55, 0x2F, 0xA9, 0x31, 0xB3,
        0x74, 0xCE, 0xFB, 0x10, 0x63, 0x80, 0xCC, 0x2E,
        0xCD, 0xD2, 0x05, 0xE9, 0x17, 0xF5, 0x98, 0x6D,
        0xB4, 0x5C, 0x80, 0xF6, 0xF3, 0x15, 0x7C, 0x41,
        0xC8, 0xBA, 0x02, 0x5E, 0x62
    };

    unsigned char b3[] = {
        0x04, 0xFB, 0xE6, 0xBA, 0x2D, 0xAB, 0x46, 0x6C,
        0xF0, 0x90, 0xCF, 0xFD, 0x9B, 0xF0, 0x42, 0xAA
    };

    unsigned char exp_res3[] = {
        0x01, 0x7A, 0x2F, 0x55, 0x2F, 0xA9, 0x31, 0xB3,
        0x74, 0xCE, 0xFB, 0x10, 0x63, 0x80, 0xCC, 0x2E,
        0xCD, 0xD2, 0x05, 0xE9, 0x17, 0xF0, 0x9C, 0x86,
        0xFA, 0x2E, 0xD5, 0xB0, 0x86, 0x24, 0xEB, 0x71,
        0xCB, 0x1E, 0x12, 0x1B, 0xB8
    };
    bigint_free(&c);
    bigint_init(&c, 1);
    bigint_from_bytes(&a, a3, 37);
    bigint_from_bytes(&b, b3, 16);
    bigint_from_bytes(&res, exp_res3, 37);
    bigint_sub(&a, &b, &a);

    rv = bigint_cmp(&a, &res);
    if(!rv){
        bigint_print(&c, "c = ");
        print_passed("bigint_sub_test - random bigint with different size 2 passed");
    } else {
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&res, "r = ");
        print_failed("bigint_sub_test - random bigint with different size 2 failed");
    }
    bigint_free(&c);

    bigint_init(&c, 1);
    bigint_set_zero(&b);
    bigint_sub(&a, &b, &c);
    rv = bigint_cmp(&c, &a);
    if(!rv){
        bigint_print(&c, "c = ");
        print_passed("bigint_sub_test - random bigint sub 0 passed");
    } else {
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&a, "r = ");
        print_failed("bigint_sub_test - random bigint sub 0 failed");
    }

    bigint_free(&a);
    bigint_free(&b);
    bigint_free(&c);
    bigint_free(&res);
    return failed;
}

int bigint_sub_digit_test(){
    int failed = 0;
    // print_msg(YELLOW, "bigint_sub_digit_test");

    unsigned char a1[] = {
        0x04, 0x94, 0xF7, 0x07, 0xF5, 0xF2, 0xC9, 0x87,
        0x98, 0xE2, 0x19, 0x23, 0x5A, 0x87, 0xF9, 0x27
    };
    digit b = 0x05D58E;
    unsigned char exp_res[] = {
        0x04, 0x94, 0xF7, 0x07, 0xF5, 0xF2, 0xC9, 0x87,
        0x98, 0xE2, 0x19, 0x23, 0x5A, 0x82, 0x23, 0x99
    };

    int rv = 0;
    bigint a, c, r;
    bigint_init(&a, 1);
    bigint_init(&c, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&r, exp_res, 16);
    bigint_sub_digit(&a, b, &c);
    rv = bigint_cmp(&c, &r);
    if(!rv){
        bigint_print(&c, "c = ");
        print_passed("bigint_sub_digit_test - random bigint passed");
    } else {
        failed = 1;
        bigint_print(&a, "a = ");
        printf("b = %08X\n", b);
        // bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_sub_digit_test - random bigint failed");
    }

    bigint_free(&a);
    bigint_free(&r);
    bigint_free(&c);
    return failed;
}

int bigint_mul_test(){
    int failed = 0;
    bigint a, b, c, r;
    int res = 0;
    unsigned char a1[] = {
        0xC6, 0x0B, 0x2C, 0xFD, 0x16, 0x9D, 0x96, 0x84,
        0xA1, 0xD9, 0x16, 0x5D, 0xBA, 0xA9, 0x9A, 0x43
    };

    unsigned char b1[] = {
        0x0E, 0x43, 0xB0, 0x3C, 0xE1, 0xB4, 0xB0, 0x31,
        0xA8, 0x9B, 0xCF, 0x2A, 0xA4, 0x41, 0x9C, 0xB7
    };

    unsigned char exp_res[] = {
        0x0B, 0x08, 0xF9, 0xB9, 0x65, 0xA1, 0xAF, 0x0B,
        0x76, 0x50, 0x94, 0x09, 0x96, 0x81, 0x74, 0xF8,
        0xF7, 0x76, 0xBA, 0xB1, 0x34, 0x4E, 0xF3, 0xF1,
        0xD7, 0x51, 0xA2, 0xA0, 0xE0, 0x41, 0x19, 0xE5
    };

    bigint_init(&a, 1);
    bigint_init(&b, 1);
    bigint_init(&c, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&b, b1, 16);
    bigint_from_bytes(&r, exp_res, 32);

    bigint_mul_karatsuba(&a, &b, &a);
    res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_mul_test - Karatsuba algorithm 1 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&a, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_test - Karatsuba algorithm 1 failed");
    }

    bigint_free(&c);

    unsigned char a2[] = {
        0x2B, 0xD7, 0xE5, 0x45, 0x67, 0xAF, 0x8F, 0xE6,
        0xBA, 0xC1, 0x89, 0xFE, 0xF6, 0xCF, 0x09, 0x7D
    };

    unsigned char b2[] = {
        0x04, 0xAA, 0xAC, 0x5F, 0x05, 0x32, 0x1E, 0xCA,
        0x6A, 0x9C, 0x52, 0x38, 0xAF, 0xDC, 0x11, 0x83
    };

    unsigned char exp_res2[] = {
        0xCC, 0x9A, 0x78, 0xA9, 0xC2, 0x1C, 0x2B, 0xB3,
        0x08, 0x5A, 0x5E, 0x45, 0xD2, 0x05, 0xBD, 0x4F,
        0x5E, 0xE5, 0x20, 0xEB, 0x55, 0xDE, 0xAE, 0x25,
        0x87, 0x4A, 0x9C, 0xA5, 0xFF, 0x27, 0xF7
    };

    bigint_from_bytes(&a, a2, 16);
    bigint_from_bytes(&b, b2, 16);
    bigint_from_bytes(&r, exp_res2, 31);

    bigint_init(&c, 1);
    bigint_mul_karatsuba(&a, &b, &a);
    res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_mul_test - Karatsuba algorithm 2 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&a, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_test - Karatsuba algorithm 2 failed");
    }

    bigint_free(&c);

    unsigned char a3[65] = {
        0xFC, 0xA9, 0xD0, 0xFE, 0xD9, 0x51, 0xCC, 0x3C,
        0x54, 0x1E, 0x6D, 0xE5, 0x4D, 0x3E, 0x15, 0xE9,
        0x30, 0x41, 0x92, 0xFC, 0x5E, 0xAA, 0xA6, 0x89,
        0x35, 0xE3, 0x6A, 0x76, 0xA4, 0xBD, 0xE6, 0x17,
        0x53, 0x6F, 0xEF, 0x86, 0x73, 0x0D, 0xE7, 0xC6,
        0xA6, 0x63, 0x2A, 0x1F, 0xC9, 0xB5, 0x7B, 0xAE,
        0x2E, 0x25, 0x7E, 0x5E, 0xF2, 0x5C, 0x70, 0x31,
        0x76, 0x3C, 0x27, 0x80, 0x60, 0x14, 0xFA, 0x76,
        0xA5
    };

    unsigned char b3[16] = {
        0x5F, 0xB5, 0x46, 0xD1, 0x30, 0xAD, 0xE7, 0x3F,
        0x4C, 0x39, 0x74, 0xB5, 0x89, 0x58, 0x0C, 0x17
    }; 

    unsigned char exp_res3[81] = {
        0x5E, 0x75, 0xEE, 0x84, 0x3C, 0xA9, 0xCB, 0x49,
        0x4D, 0x12, 0xB6, 0xFA, 0xB8, 0x39, 0x03, 0xED,
        0x78, 0x4A, 0x99, 0x58, 0x1E, 0xF2, 0x97, 0x44,
        0xA2, 0x0C, 0x9B, 0x64, 0xAF, 0xBD, 0xC1, 0xC6,
        0x7C, 0x5D, 0x48, 0xC6, 0xFC, 0xE5, 0x93, 0xC7,
        0x35, 0xE5, 0x0C, 0x4E, 0x83, 0x18, 0xBD, 0x05,
        0x7F, 0x87, 0xB7, 0x9C, 0x82, 0x75, 0xFD, 0x97,
        0x65, 0x73, 0x70, 0x45, 0xFD, 0x72, 0x78, 0xF1,
        0x7E, 0xE2, 0x82, 0xC8, 0xB0, 0xA9, 0x27, 0x37,
        0xC1, 0x87, 0x67, 0xEF, 0xDD, 0xB5, 0xC8, 0x64,
        0xD3
    };

    bigint_from_bytes(&a, a3, 65);
    bigint_from_bytes(&b, b3, 16);
    bigint_from_bytes(&r, exp_res3, 81);

    bigint_init(&c, 1);
    bigint_mul_karatsuba(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(!res){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_test - Karatsuba algorithm 3 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_test - Karatsuba algorithm 3 failed");
    }

    bigint_free(&c);

    unsigned char zeros[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };

    bigint_from_bytes(&b, zeros, 8);
    bigint_init(&c, 1); 

    bigint_mul(&a, &b, &c);
    res = bigint_cmp_zero(&c);

    if(!res){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_test - random bigint mul zero passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_test - random bigint mul zero failed");
    }

    bigint_free(&c);

    unsigned char a4[] = {
        0x85, 0x1B, 0xD0, 0x7B, 0xA8, 0x84, 0x8B, 0x78,
        0x72, 0x66, 0xE4, 0x9E, 0xBF, 0x99, 0x06, 0x2E
    };

    unsigned char b4[] = { 0x07, 0x83, 0xCF };

    unsigned char exp_res4[] = {
        0x03, 0xE8, 0x4B, 0x90, 0x8E, 0x76, 0xD8, 0xE6,
        0xD6, 0x89, 0xBF, 0x68, 0x87, 0x55, 0x97, 0x66,
        0x27, 0x89, 0x32
    };

    bigint_from_bytes(&a, a4, 16);
    bigint_from_bytes(&b, b4, 3);
    bigint_from_bytes(&r, exp_res4, 19);
    bigint_init(&c, 1); 

    bigint_mul(&a, &b, &c);
    res = bigint_cmp(&c, &r);

    if(!res){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_test - random bigint 4 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_test - random bigint 4 failed");
    }

    unsigned char a5[] = {
        0xE8, 0x0E, 0x90, 0xBD, 0xA3, 0x4F, 0x91, 0x22,
        0x57, 0x73, 0xBF, 0x70, 0xDA, 0x55, 0xFE, 0x7F
    };  

    unsigned char r5[] = {
        0xD2, 0x5A, 0x67, 0x2B, 0xDE, 0x93, 0xF7, 0xF6,
        0x2D, 0x34, 0xB6, 0x49, 0x75, 0x32, 0xAB, 0xD7,
        0x7C, 0x59, 0x7C, 0x72, 0x78, 0x79, 0xAB, 0x85,
        0x0F, 0x50, 0xC3, 0x73, 0x49, 0x56, 0x43, 0x01
    };

    bigint_from_bytes(&a, a5, 16);
    bigint_from_bytes(&r, r5, 32);

    bigint_square(&a, &a);
    res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_square_test - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_square_test - failed");
    }

    unsigned char a6[] = {
        0x4D, 0xD6, 0xD9, 0xFC, 0x52, 0x0A, 0x4C, 0xB2,
        0xAD, 0x67, 0x0A, 0x95, 0x0C, 0x84, 0xFE, 0xA0
    };  

    unsigned char r6[] = {
        0x17, 0xAA, 0xF3, 0x72, 0xF4, 0xD1, 0x17, 0x22,
        0xCB, 0xA2, 0x67, 0xED, 0xF9, 0x8C, 0x96, 0xAF,
        0x27, 0xB2, 0x5C, 0xFD, 0xBB, 0xEC, 0xE5, 0x6B,
        0x1C, 0x11, 0xA3, 0x36, 0x92, 0x41, 0xE4, 0x00
    };

    bigint_from_bytes(&a, a6, 16);
    bigint_from_bytes(&r, r6, 32);

    bigint_square(&a, &a);
    res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_square_test 2 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_square_test 2 - failed");
    }

    unsigned char a7[] = {
        0x1E, 0x3D, 0x01, 0xAC, 0x88, 0x37, 0xDE, 0xE5,
        0xDF, 0xE0, 0xBF, 0xFF, 0xFB, 0x93, 0xFE, 0x04
    };  

    unsigned char r7[] = {
        0x03, 0x92, 0x5A, 0xEE, 0x3C, 0x28, 0xD0, 0x35,
        0xDD, 0x52, 0x17, 0xC5, 0xDD, 0x2F, 0x11, 0x47,
        0xC8, 0xED, 0x80, 0xF8, 0xB1, 0x4F, 0x74, 0x0D,
        0x7C, 0x19, 0x8D, 0xA1, 0x8C, 0xA3, 0xF0, 0x10
    };

    bigint_from_bytes(&a, a7, 16);
    bigint_from_bytes(&r, r7, 32);

    bigint_square(&a, &c);
    res = bigint_cmp(&c, &r);
    if(!res){
        bigint_print(&c, "c = ");
        print_passed("bigint_square_test 3 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_square_test 3 - failed");
    }

    unsigned char a8[] = {
        0x28, 0x4A, 0x50, 0x91, 0x41, 0x8F, 0x42, 0x3D,
        0xB9, 0xBB, 0x92, 0x0E, 0xA0, 0x0B, 0x54, 0x3D
    };  

    unsigned char r8[] = {
        0x06, 0x57, 0x4E, 0xC0, 0x11, 0xD1, 0xC6, 0xEA,
        0x74, 0x33, 0xAB, 0xE5, 0x0E, 0xA7, 0x4B, 0xD7,
        0x7F, 0xCF, 0xE2, 0x8F, 0x0A, 0xFE, 0x78, 0xC2,
        0x0C, 0x7E, 0xF4, 0x78, 0x98, 0xF6, 0x16, 0x89
    };

    bigint_from_bytes(&a, a8, 16);
    bigint_from_bytes(&r, r8, 32);

    bigint_square(&a, &a);
    res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_square_test 4 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_square_test 4 - failed");
    }

    unsigned char a9[] = {
        0x0B, 0xBE, 0xD5, 0xD7, 0x27, 0x03, 0xCC, 0x20,
        0x9F, 0x9E, 0x90, 0xE5, 0xFE, 0x54, 0x77, 0x90,
        0x1B, 0x05, 0x21, 0xB0, 0xAD, 0x2E, 0xAC, 0x77,
        0xC2, 0x55, 0xA3, 0x70, 0x6C, 0xCE, 0xEE, 0x90
    };  

    unsigned char r9[] = {
        0x89, 0xF4, 0xA2, 0x9B, 0x57, 0xF8, 0xEC, 0xAE,
        0x25, 0xE0, 0x7D, 0x2E, 0xE0, 0xF3, 0x9C, 0x18,
        0x0C, 0x00, 0xFA, 0xE6, 0xEF, 0xD6, 0x0F, 0x07,
        0x7C, 0x8F, 0x0D, 0x36, 0xED, 0x86, 0x42, 0xA2,
        0x4C, 0x06, 0x64, 0x89, 0x45, 0xDA, 0x06, 0x05,
        0xCD, 0x04, 0xA8, 0xC8, 0x34, 0x99, 0xE0, 0xA9,
        0xE2, 0xDB, 0xE3, 0xEA, 0x9D, 0x88, 0xCB, 0x92,
        0xBB, 0x5E, 0x8E, 0x4E, 0x10, 0x11, 0x00
    };

    bigint_from_bytes(&a, a9, 32);
    bigint_from_bytes(&r, r9, 63);

    bigint_square(&a, &a);
    res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_square_test 5 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_square_test 5 - failed");
    }

    unsigned char a10[] = {
        0xAB, 0xA2, 0xAE, 0x6E, 0x1A, 0x38, 0x38, 0x93,
        0x32, 0xB7, 0xEA, 0x6D, 0xBB, 0x04, 0x1B, 0x67,
        0x76, 0xDE, 0x97, 0xC4, 0x24, 0x04, 0x98, 0x1E,
        0xF2, 0x09, 0x29, 0x38, 0x3B, 0xA5, 0xD2, 0x96
    };  

    unsigned char b10[] = {
        0xAB, 0xC4, 0x79, 0xE0, 0xD2, 0x18, 0x7C, 0x69,
        0xA6, 0x48, 0x86, 0x0D, 0xC6, 0xD6, 0x27, 0x9E,
        0xBB, 0x1D, 0xBA, 0x34, 0xD8, 0x56, 0xEC, 0x4A,
        0xB0, 0x76, 0xC3, 0x64, 0x14, 0x05, 0x43, 0x66,
        0xC8, 0x28, 0x80, 0x9D, 0x14, 0xA6, 0x5C, 0xBF,
        0xD8, 0xE9, 0x0D, 0x79, 0x45, 0x9A, 0x05, 0x5F
    };

    unsigned char r10[] = {
        0x73, 0x29, 0x64, 0xC7, 0xB7, 0x76, 0x29, 0x51,
        0x75, 0x0A, 0x52, 0x72, 0xF8, 0x5F, 0xC4, 0x9F,
        0xD8, 0x59, 0xD2, 0x1F, 0x34, 0x1E, 0xD6, 0x88,
        0xC6, 0xDA, 0xF4, 0xD2, 0xA3, 0xCC, 0x22, 0x1C,
        0xAA, 0x18, 0x99, 0x6F, 0x87, 0x54, 0x98, 0x11,
        0xD7, 0xCF, 0x72, 0x03, 0x25, 0x47, 0x83, 0x67,
        0x63, 0xB4, 0x7D, 0x8F, 0x58, 0xAD, 0x34, 0xAC,
        0x6F, 0xFA, 0xE8, 0xE4, 0xEE, 0xF6, 0xC0, 0x55,
        0x05, 0xBE, 0x4A, 0xA6, 0x80, 0x1F, 0xAF, 0xF5,
        0xCA, 0xB4, 0x1F, 0x71, 0x7B, 0xE2, 0x13, 0xAA
    };
   
    bigint_from_bytes(&a, a10, 32);
    bigint_from_bytes(&b, b10, 48);
    bigint_from_bytes(&r, r10, 80);

    bigint_mul(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(!res){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_tset - very large numbers 1 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_test - very large numbers 1 failed");
    }

    unsigned char a11[] = {
        0x3D, 0x69, 0x2E, 0x9C, 0xFF, 0x7F, 0x83, 0x8B,
        0x72, 0xC7, 0x11, 0x4B, 0x95, 0x06, 0xC2, 0x39,
        0x5A, 0x75, 0xC7, 0xEC, 0xF2, 0x8E, 0x91, 0x18,
        0xC2, 0x2B, 0x2F, 0xED, 0x4A, 0xE8, 0x0A, 0x55,
        0x3D, 0x0E, 0x58, 0xE5, 0x6D, 0x92, 0x61, 0x15,
        0x76, 0xF7, 0x2B, 0x70, 0x00, 0x1D, 0xFC, 0x8C,
        0x51, 0x89, 0xCB, 0xD6, 0x34, 0xEA, 0x78, 0xC5,
        0xAB, 0xFD, 0x3D, 0x13, 0x25, 0xD4, 0xF0, 0x81
    };  

    unsigned char b11[] = {
        0xF9, 0x46, 0xD3, 0xB6, 0x32, 0xD0, 0xA5, 0x7A,
        0x81, 0x9C, 0x0B, 0x52, 0x5B, 0x78, 0xE5, 0x0E,
        0x72, 0xD4, 0x5B, 0xFB, 0x38, 0x58, 0x54, 0xFE,
        0xC7, 0xBD, 0x57, 0x79, 0x9B, 0x9B, 0xAE, 0xDB,
        0x1C, 0xB3, 0x10, 0x06, 0xF1, 0x19, 0x38, 0x3B,
        0x51, 0xCD, 0x80, 0x75, 0xA2, 0xA6, 0x07, 0x11
    };

    unsigned char r11[] = {
        0x3B, 0xCC, 0x4B, 0xE2, 0xD9, 0xD4, 0x06, 0x47,
        0x10, 0x91, 0xCD, 0x16, 0xC6, 0xB9, 0xA2, 0xF5,
        0x30, 0xCF, 0x40, 0xB6, 0x4A, 0x61, 0x08, 0xE6,
        0xEB, 0x11, 0x75, 0x16, 0x5C, 0xF0, 0xE3, 0xAA,
        0x62, 0x24, 0xF2, 0x99, 0x35, 0x59, 0x83, 0x89,
        0x7C, 0x93, 0xC6, 0x43, 0x84, 0xAA, 0x96, 0x62,
        0xAF, 0xA0, 0x99, 0xA9, 0xFC, 0x3C, 0x73, 0xEF,
        0xFE, 0x31, 0xC1, 0x0F, 0x1D, 0xBA, 0x91, 0x05,
        0x76, 0x6F, 0x2A, 0xD7, 0x96, 0xDB, 0xF3, 0x25,
        0xCD, 0xE1, 0x1C, 0x6C, 0x72, 0x02, 0x21, 0xE6,
        0x6A, 0xB7, 0x26, 0x6A, 0xE3, 0x28, 0x55, 0xFC,
        0xBF, 0xDC, 0xF6, 0xB8, 0x66, 0x57, 0x91, 0xFE,
        0x14, 0xCC, 0x16, 0x81, 0xBE, 0xC0, 0x01, 0xB3,
        0x3B, 0xB7, 0x47, 0x88, 0xEB, 0x5D, 0x7F, 0x91
    };
   
    bigint_from_bytes(&a, a11, 64);
    bigint_from_bytes(&b, b11, 48);
    bigint_from_bytes(&r, r11, 112);

    bigint_mul(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(!res){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_tset - very large numbers 2 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_test - very large numbers 2 failed");
    }

    bigint_from_bytes(&a, a11, 64);
    bigint_from_bytes(&b, b11, 48);
    bigint_from_bytes(&r, r11, 112);

    bigint_mul_karatsuba(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(!res){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_karatsuba_tset - very large numbers 1 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_karatsuba_tset - very large numbers 1 failed");
    }

    bigint_free(&a);
    bigint_free(&b);
    bigint_free(&c);
    bigint_free(&r);
    return failed;
}

int bigint_double_test(){
    int failed = 0;
    bigint a, c, r;

    unsigned char a1[] = {
        0xEF, 0xBC, 0xEF, 0xE1, 0x21, 0x2F, 0xC6, 0x7E,
        0xEA, 0x46, 0x1B, 0x98, 0x96, 0xB9, 0xC1, 0x97
    };

    unsigned char exp_res[] = {
        0x01, 0xDF, 0x79, 0xDF, 0xC2, 0x42, 0x5F, 0x8C,
        0xFD, 0xD4, 0x8C, 0x37, 0x31, 0x2D, 0x73, 0x83,
        0x2E
    };

    bigint_init(&a, 1);
    bigint_init(&c, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&r, exp_res, 17);
    
    bigint_double(&a, &a);
    int res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_double_test - random bigint passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_double_test - random bigint failed");
    }

    bigint_set_zero(&a);
    bigint_double(&a, &c);
    res = bigint_cmp_zero(&c);

    if(!res){
        bigint_print(&c, "c = ");
        print_passed("bigint_double_test - zero passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_double_test - zero failed");
    }

    bigint_free(&a);
    bigint_free(&c);
    bigint_free(&r);

    return failed;
}

int bigint_halve_test(){
    int failed = 0;

    bigint a, c, r;

    unsigned char a1[] = {
        0xDA, 0x81, 0xFF, 0x99, 0x8B, 0x70, 0x29, 0x4F,
        0xE1, 0x75, 0xA6, 0x55, 0xA9, 0xFA, 0xA1, 0x16
    };

    unsigned char r1[] = {
        0x6D, 0x40, 0xFF, 0xCC, 0xC5, 0xB8, 0x14, 0xA7,
        0xF0, 0xBA, 0xD3, 0x2A, 0xD4, 0xFD, 0x50, 0x8B
    };

    bigint_init(&a, 1);
    bigint_init(&c, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&r, r1, 16);
    
    bigint_halve(&a, &a);
    int res = bigint_cmp(&r, &a);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_halve_test - random bigint passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_halve_test - random bigint failed");
    }

    bigint_set_zero(&a);
    bigint_halve(&a, &c);
    res = bigint_cmp_zero(&c);
    if(!res){
        bigint_print(&c, "c = ");
        print_passed("bigint_halve_test - zero passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        print_failed("bigint_halve_test - zero failed");
    }

    unsigned char a2[] = {
        0x1F, 0x7E, 0x77, 0x68, 0x2F, 0x15, 0x24, 0x9C,
        0x9B, 0xD1, 0xD2, 0xED, 0xDE, 0x4C, 0xF4, 0x61
    };

    unsigned char r2[] = {
        0x0F, 0xBF, 0x3B, 0xB4, 0x17, 0x8A, 0x92, 0x4E,
        0x4D, 0xE8, 0xE9, 0x76, 0xEF, 0x26, 0x7A, 0x30
    };

    bigint_from_bytes(&a, a2, 16);
    bigint_from_bytes(&r, r2, 16);

    bigint_set_zero(&c);
    bigint_halve(&a, &c);
    res = bigint_cmp(&c, &r);
    if(!res){
        bigint_print(&c, "c = ");
        print_passed("bigint_halve_test - odd number passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_halve_test - odd number failed");
    }

    unsigned char a3[] = {
        0x9B, 0x82, 0x81, 0xF0, 0xEC, 0xC4, 0xAB, 0xAD,
        0x7B, 0x56, 0xD1, 0xEF, 0x18, 0xCD, 0xBB, 0x20
    };

    unsigned char r3[] = {
        0x4D, 0xC1, 0x40, 0xF8, 0x76, 0x62, 0x55, 0xD6,
        0xBD, 0xAB, 0x68, 0xF7, 0x8C, 0x66, 0xDD, 0x90
    };

    bigint_from_bytes(&a, a3, 16);
    bigint_from_bytes(&r, r3, 16);

    bigint_set_zero(&c);
    bigint_halve(&a, &a);
    res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_halve_test - odd number passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_halve_test - odd number failed");
    }

    unsigned char a4[] = {
        0x59, 0xD7, 0xD4, 0x9C, 0x46, 0x50, 0x8B, 0x36,
        0x35, 0xB2, 0x7E, 0x13, 0x2A, 0x66, 0xC4, 0x58,
        0x8B, 0x04, 0xA2, 0x81, 0x08, 0x88, 0x3F, 0x2F,
        0x1B, 0x71, 0xBA, 0x2B, 0x62, 0xC6, 0xEF, 0x65,
        0x8F, 0x7B, 0x4C, 0x04, 0x95, 0xB6, 0x17, 0xB0,
        0x3F, 0x3B, 0xCB, 0x45, 0x3B, 0xE5, 0xCA, 0x80,
        0x1C, 0xB6, 0x3A, 0xF9, 0x22, 0x79, 0x67, 0x5B,
        0xA2, 0xDD, 0xE4, 0xF1, 0xE0, 0x8D, 0x46, 0xCB,
        0x3F, 0x46, 0xEF, 0x2E
    };

    unsigned char r4[] = {
        0x2C, 0xEB, 0xEA, 0x4E, 0x23, 0x28, 0x45, 0x9B,
        0x1A, 0xD9, 0x3F, 0x09, 0x95, 0x33, 0x62, 0x2C,
        0x45, 0x82, 0x51, 0x40, 0x84, 0x44, 0x1F, 0x97,
        0x8D, 0xB8, 0xDD, 0x15, 0xB1, 0x63, 0x77, 0xB2,
        0xC7, 0xBD, 0xA6, 0x02, 0x4A, 0xDB, 0x0B, 0xD8,
        0x1F, 0x9D, 0xE5, 0xA2, 0x9D, 0xF2, 0xE5, 0x40,
        0x0E, 0x5B, 0x1D, 0x7C, 0x91, 0x3C, 0xB3, 0xAD,
        0xD1, 0x6E, 0xF2, 0x78, 0xF0, 0x46, 0xA3, 0x65,
        0x9F, 0xA3, 0x77, 0x97
    };

    bigint_from_bytes(&a, a4, 68);
    bigint_from_bytes(&r, r4, 68);

    bigint_set_zero(&c);
    bigint_halve(&a, &a);
    res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_halve_test - large number passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_halve_test - large number failed");
    }

    unsigned char a5[] = {
        0xE6, 0x1F, 0xD3, 0x91, 0x16, 0xB2, 0x61, 0x46,
        0x69, 0x4D, 0x0E, 0x27, 0xF2, 0x34, 0x0C, 0x5A,
        0xB3, 0x21, 0xEA, 0x8F, 0x8D, 0x46, 0x5B, 0x48,
        0xDD, 0x00, 0xA3, 0xDF, 0x59, 0xDC, 0x68, 0xEF,
        0x64, 0x5C, 0xE1, 0x56, 0xF4, 0x2F, 0xA4, 0xF6,
        0x6D, 0x93, 0x25, 0xC0, 0xD6, 0x22, 0x89, 0xAC,
        0xB2, 0x58, 0xD7, 0x35, 0xB5, 0x56, 0x62, 0xF4,
        0xBD, 0xFD, 0xD0, 0x58, 0x47, 0x49, 0x78, 0x63,
        0x0E, 0xCA, 0xFD, 0xEF, 0xBA, 0x6F, 0xA6, 0xC7,
        0x85, 0x5E, 0xA2, 0x30, 0x4E, 0xFA, 0xFF, 0x37,
        0x16, 0x38, 0x90, 0x7E, 0x6C, 0x17, 0x4B, 0x54,
        0xE9, 0x69, 0x80, 0x8A, 0xA4, 0x09, 0x14, 0x6B,
        0x7C, 0x4B, 0x37, 0xBB, 0xFA, 0x5A, 0xA4, 0x17,
        0xCC, 0x89, 0x8C, 0x05, 0x0A, 0x48, 0x88, 0x10,
        0x94, 0x96, 0xC4, 0x0D, 0x4D, 0x16, 0x4A, 0xF3,
        0x2D, 0xE6, 0x29, 0x3F, 0x1C, 0x4A, 0xCE, 0x4B
    };

    unsigned char r5[] = {
        0x73, 0x0F, 0xE9, 0xC8, 0x8B, 0x59, 0x30, 0xA3,
        0x34, 0xA6, 0x87, 0x13, 0xF9, 0x1A, 0x06, 0x2D,
        0x59, 0x90, 0xF5, 0x47, 0xC6, 0xA3, 0x2D, 0xA4,
        0x6E, 0x80, 0x51, 0xEF, 0xAC, 0xEE, 0x34, 0x77,
        0xB2, 0x2E, 0x70, 0xAB, 0x7A, 0x17, 0xD2, 0x7B,
        0x36, 0xC9, 0x92, 0xE0, 0x6B, 0x11, 0x44, 0xD6,
        0x59, 0x2C, 0x6B, 0x9A, 0xDA, 0xAB, 0x31, 0x7A,
        0x5E, 0xFE, 0xE8, 0x2C, 0x23, 0xA4, 0xBC, 0x31,
        0x87, 0x65, 0x7E, 0xF7, 0xDD, 0x37, 0xD3, 0x63,
        0xC2, 0xAF, 0x51, 0x18, 0x27, 0x7D, 0x7F, 0x9B,
        0x8B, 0x1C, 0x48, 0x3F, 0x36, 0x0B, 0xA5, 0xAA,
        0x74, 0xB4, 0xC0, 0x45, 0x52, 0x04, 0x8A, 0x35,
        0xBE, 0x25, 0x9B, 0xDD, 0xFD, 0x2D, 0x52, 0x0B,
        0xE6, 0x44, 0xC6, 0x02, 0x85, 0x24, 0x44, 0x08,
        0x4A, 0x4B, 0x62, 0x06, 0xA6, 0x8B, 0x25, 0x79,
        0x96, 0xF3, 0x14, 0x9F, 0x8E, 0x25, 0x67, 0x25
    };

    bigint_from_bytes(&a, a5, 128);
    bigint_from_bytes(&r, r5, 128);

    bigint_set_zero(&c);
    bigint_halve(&a, &a);
    res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_halve_test - large number 2 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_halve_test - large number 2 failed");
    }

    bigint_free(&a);
    bigint_free(&c);
    bigint_free(&r);

    return failed;
}

int bigint_bitwise_op_test(){
    int failed = 0;

    bigint a,b,c,r;
    print_msg(YELLOW, "=== bitwise AND test ===");
    unsigned char a_and1[] = {
        0x32, 0x45, 0x63, 0x35, 0x97, 0x14, 0xF3, 0x4D,
        0x6C, 0xBE, 0xEA, 0x00, 0x24, 0x83, 0x70, 0x6E
    };

    unsigned char b_and1[] = {
        0x3C, 0x1B, 0xBF, 0x1C, 0xD1, 0xE2, 0x9D, 0x17,
        0xF6, 0x67, 0x75, 0x23, 0xF7, 0x41, 0x70, 0xE7
    };

    unsigned char exp_res_and1[] = {
        0x30, 0x01, 0x23, 0x14, 0x91, 0x00, 0x91, 0x05,
        0x64, 0x26, 0x60, 0x00, 0x24, 0x01, 0x70, 0x66
    };

    bigint_init(&a, 1);
    bigint_init(&b, 1);
    bigint_init(&c, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a_and1, 16);
    bigint_from_bytes(&b, b_and1, 16);
    bigint_from_bytes(&r, exp_res_and1, 16);

    bigint_and(&a, &b, &a);

    int res = bigint_cmp(&a, &r);
    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_and_test - random bigint 4 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&a, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_and_test - random bigint 4 failed");
    }

    bigint_free(&c);
    
    unsigned char b_and2[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    };

    bigint_init(&c, 1);
    bigint_set_zero(&b);
    bigint_from_bytes(&b, b_and2, 8);
    bigint_and(&a, &b, &a);
    res = bigint_cmp_zero(&a);

    if(!res){
        bigint_print(&a, "c = ");
        print_passed("bigint_and_test - random bigint 4 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&a, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_and_test - random bigint 4 failed");
    }

    print_msg(YELLOW, "=== bitwise OR test ===");

    unsigned char a_or1[] = {
        0x88, 0x19, 0x3A, 0x31, 0x8B, 0xDC, 0xEF, 0x4F,
        0x45, 0xBF, 0x79, 0xB4, 0xBE, 0x7B, 0x3E, 0x2D
    };

    unsigned char b_or1[] = {
        0xCD, 0xC2, 0x82, 0x49, 0xC2, 0xFE, 0xF4, 0xC5,
        0x6F, 0xE5, 0xD4, 0x4C, 0xD3, 0xB1, 0xB1, 0x15
    };

    unsigned char exp_res_or1[] = {
        0xCD, 0xDB, 0xBA, 0x79, 0xCB, 0xFE, 0xFF, 0xCF,
        0x6F, 0xFF, 0xFD, 0xFC, 0xFF, 0xFB, 0xBF, 0x3D
    };

    bigint_from_bytes(&a, a_or1, 16);
    bigint_from_bytes(&b, b_or1, 16);
    bigint_from_bytes(&r, exp_res_or1, 16);
    bigint_set_zero(&c);
    bigint_or(&a, &b, &c);
    res = bigint_cmp(&c, &r);

    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_or_test - random bigint 128 bits passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_or_test - random bigint 128 bits failed");
    }

    unsigned char b_or2[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    }; 
    bigint_from_bytes(&b, b_or2, 8);
    bigint_set_zero(&c);
    bigint_or(&a, &b, &c);
    res = bigint_cmp(&c, &a);

    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_or_test - random bigint OR 0 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_or_test - random bigint OR 0 failed");
    }

    unsigned char b_or3[] = {
        0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
        0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF
    };

    bigint_from_bytes(&b, b_or3, 16);
    bigint_set_zero(&c);
    bigint_or(&a, &b, &c);
    res = bigint_cmp(&c, &b);

    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_or_test - random bigint OR all 1 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_or_test - random bigint OR all 1 failed");
    }

    print_msg(YELLOW, "=== bitwise XOR test ===");

    unsigned char a_xor1[] = {
        0x58, 0x33, 0x33, 0xC9, 0x19, 0xCF, 0xD1, 0x4C,
        0x9B, 0x35, 0x6D, 0xEC, 0x63, 0x2C, 0x9E, 0xF8
    };

    unsigned char b_xor1[] = {
        0x57, 0xC5, 0x02, 0x4A, 0x06, 0x05, 0x62, 0x41,
        0x8B, 0x8F, 0x09, 0xBA, 0x0B, 0x1B, 0x1C, 0xB6
    };

    unsigned char exp_res_xor1[] = {
        0x0F, 0xF6, 0x31, 0x83, 0x1F, 0xCA, 0xB3, 0x0D,
        0x10, 0xBA, 0x64, 0x56, 0x68, 0x37, 0x82, 0x4E
    };

    bigint_from_bytes(&a, a_xor1, 16);
    bigint_from_bytes(&b, b_xor1, 16);
    bigint_from_bytes(&r, exp_res_xor1, 16);
    bigint_set_zero(&c);
    bigint_xor(&a, &b, &c);
    res = bigint_cmp(&c, &r);

    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_xor_test - random bigint 128 bits passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_xor_test - random bigint 128 bits failed");
    }

    unsigned char a_xor2[] = {
        0xEF, 0x84, 0x29, 0x73, 0x75, 0x4A, 0xFD, 0xD0,
        0x0D, 0xA3, 0x9A, 0x59, 0xB5, 0x51, 0xA8, 0xF0
    };

    unsigned char b_xor2[] = {
        0x03, 0xEA, 0xE4, 0x14, 0x10, 0xEB, 0x27, 0xDB,
        0xFF, 0x10, 0xC8, 0x1A, 0x19, 0x87, 0x68, 0xA3,
        0x02, 0x7A, 0x40, 0x01, 0xB0, 0xC0, 0xEB, 0xF5,
        0xBC, 0xE9, 0xD7, 0xA3, 0x86, 0xBE, 0xB1, 0x16,
        0xBF
    };

    unsigned char exp_res_xor2[] = {
        0x03, 0xEA, 0xE4, 0x14, 0x10, 0xEB, 0x27, 0xDB,
        0xFF, 0x10, 0xC8, 0x1A, 0x19, 0x87, 0x68, 0xA3,
        0x02, 0x95, 0xC4, 0x28, 0xC3, 0xB5, 0xA1, 0x08,
        0x6C, 0xE4, 0x74, 0x39, 0xDF, 0x0B, 0xE0, 0xBE,
        0x4F
    };

    bigint_from_bytes(&a, a_xor2, 16);
    bigint_from_bytes(&b, b_xor2, 33);
    bigint_from_bytes(&r, exp_res_xor2, 33);
    bigint_set_zero(&c);
    bigint_xor(&a, &b, &c);
    res = bigint_cmp(&c, &r);

    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_xor_test - random bigint passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_xor_test - random bigint failed");
    }

    bigint_free(&a);
    bigint_free(&b);
    bigint_free(&c);
    bigint_free(&r);
    return failed;

}

int bigint_div_base_test(){
    int failed = 0;
    bigint a, c, r;

    unsigned char a1[] = {
        0x34, 0x6B, 0xA5, 0xF4, 0x83, 0x93, 0x0C, 0x73,
        0x1A, 0x16, 0x23, 0x68, 0x2C, 0x83, 0x7E, 0xA8
    };

    unsigned char r1[] = {
        0x00, 0x00, 0x00, 0x00, 0x34, 0x6B, 0xA5, 0xF4, 
        0x83, 0x93, 0x0C, 0x73, 0x1A, 0x16, 0x23, 0x68
    };

    bigint_init(&a, 1);
    bigint_init(&c, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&r, r1, 16);

    bigint_div_base(&a, &c);
    int res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_div_base_test - divide by BASE passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_div_base_test - divide by BASE failed");
    }

    unsigned char r2[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
        0x34, 0x6B, 0xA5, 0xF4, 0x83, 0x93, 0x0C, 0x73
    };

    bigint_from_bytes(&r, r2, 16);
    bigint_div_base_b(&a, &c, 2);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_div_base_test - divide by BASE^2 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_div_base_test - divide by BASE^2 failed");
    }

    unsigned char r3[] = {
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
    };
    bigint_from_bytes(&r, r3, 16);
    bigint_div_base_b(&a, &c, 4);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_div_base_test - divide by BASE^4 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_div_base_test - divide by BASE^4 failed");
    }

    bigint_div_base_b(&a, &c, 90);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_div_base_test - divide by BASE^90 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_div_base_test - divide by BASE^90 failed");
    }

    unsigned char r4[] = {
        0x34, 0x6B, 0xA5, 0xF4, 0x83, 0x93, 0x0C, 0x73,
        0x1A, 0x16, 0x23, 0x68, 0x2C, 0x83, 0x7E, 0xA8
    };
    bigint_from_bytes(&r, r4, 16);
    bigint_div_base_b(&a, &c, 0);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_div_base_test - divide by BASE^0 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_div_base_test - divide by BASE^0 failed");
    }

    bigint_free(&a);
    bigint_free(&c);
    bigint_free(&r);

    return failed;
}

int bigint_mul_base_test(){
    int failed = 0;
    bigint a, c, r;

    unsigned char a1[] = {
        0x34, 0x6B, 0xA5, 0xF4, 0x83, 0x93, 0x0C, 0x73,
        0x1A, 0x16, 0x23, 0x68, 0x2C, 0x83, 0x7E, 0xA8
    };

    unsigned char r1[] = {
        0x34, 0x6B, 0xA5, 0xF4, 0x83, 0x93, 0x0C, 0x73, 
        0x1A, 0x16, 0x23, 0x68, 0x2C, 0x83, 0x7E, 0xA8,
        0x00, 0x00, 0x00, 0x00, 
    };

    bigint_init(&a, 1);
    bigint_init(&c, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&r, r1, 20);

    bigint_mul_base(&a, &c);
    int res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_base_test - multiply by BASE passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_base_test - multiply by BASE failed");
    }

    unsigned char r2[] = {
        0x34, 0x6B, 0xA5, 0xF4, 0x83, 0x93, 0x0C, 0x73, 
        0x1A, 0x16, 0x23, 0x68, 0x2C, 0x83, 0x7E, 0xA8,
    };

    bigint_from_bytes(&r, r2, 16);

    bigint_mul_base_b(&a, &c, 0);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_base_test - multiply by BASE^0 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_base_test - multiply by BASE^0 failed");
    }

    unsigned char r3[] = {
        0x34, 0x6B, 0xA5, 0xF4, 0x83, 0x93, 0x0C, 0x73, 
        0x1A, 0x16, 0x23, 0x68, 0x2C, 0x83, 0x7E, 0xA8,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
    };
    bigint_from_bytes(&r, r3, 32);

    bigint_mul_base_b(&a, &c, 4);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_base_test - multiply by BASE^4 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_base_test - multiply by BASE^4 failed");
    }

    bigint_free(&a);
    bigint_free(&c);
    bigint_free(&r);

    return failed;
}

int bigint_mul_pow_2_test(){
    int failed = 0;
    bigint a, c, r;

    unsigned char a1[] = {
        0x34, 0x6B, 0xA5, 0xF4, 0x83, 0x93, 0x0C, 0x73,
        0x1A, 0x16, 0x23, 0x68, 0x2C, 0x83, 0x7E, 0xA8
    };

    unsigned char r1[] = {
        0x34, 0x6B, 0xA5, 0xF4, 0x83, 0x93, 0x0C, 0x73, 
        0x1A, 0x16, 0x23, 0x68, 0x2C, 0x83, 0x7E, 0xA8,
        0x00, 0x00, 0x00, 0x00, 
    };

    bigint_init(&a, 1);
    bigint_init(&c, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&r, r1, 20);

    bigint_mul_pow_2(&a, 32, &c);
    int res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_pow_2_test - multiply by 2^32 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_pow_2_test - multiply by 2^32 failed");
    }

    unsigned char a2[] = {
        0x1C, 0x41, 0x33, 0x0A, 0x14, 0x6A, 0xBC, 0x70,
        0x71, 0x3A, 0x1D, 0x1F, 0xF4, 0xEF, 0x96, 0x14
    };

    unsigned char r2[] = {
        0x01, 0xC4, 0x13, 0x30, 0xA1, 0x46, 0xAB, 0xC7,
        0x07, 0x13, 0xA1, 0xD1, 0xFF, 0x4E, 0xF9, 0x61,
        0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
        0x00
    };

    bigint_from_bytes(&a, a2, 16);
    bigint_from_bytes(&r, r2, 25);

    bigint_set_zero(&c);
    bigint_mul_pow_2(&a, 68, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_pow_2_test - multiply by 2^68 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_pow_2_test - multiply by 2^68 failed");
    }

    bigint_from_small_int(&a, 1);
    bigint_from_small_int(&r, 4);
    bigint_mul_pow_2(&a, 2, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mul_pow_2_test - multiply by 2^2 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mul_pow_2_test - multiply by 2^2 failed");
    }

    bigint_free(&a);
    bigint_free(&c);
    bigint_free(&r);

    return failed;
}

int bigint_div_pow_2_test(){
    int failed = 0;
    bigint a, c, r;
    int res = 0;

    unsigned char a1[] = {
        0xDD, 0x68, 0xA1, 0x80, 0x9A, 0x03, 0xFE, 0xA1,
        0xF5, 0x8B, 0x2B, 0x9D, 0xB1, 0x5E, 0x24, 0xB6
    };

    unsigned char r1[] = {
        0x0D, 0xD6, 0x8A, 0x18, 0x09, 0xA0, 0x3F, 0xEA,
        0x1F, 0x58, 0xB2, 0xB9, 0xDB 
    };

    bigint_init(&a, 1);
    bigint_init(&c, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&r, r1, 13);

    bigint_div_pow_2(&a, 28, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_div_pow_2_test - divide by 2^28 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_div_pow_2_test - divide by 2^28 failed");
    }

    unsigned char a2[] = {
        0xDC, 0xAE, 0x9E, 0xEA, 0x8E, 0xCE, 0x7D, 0xC5,
        0xE1, 0xAC, 0x61, 0x2B, 0x5D, 0xB1, 0x8F, 0x12
    };

    unsigned char r2[] = {
        0xDC, 0xAE, 0x9E, 0xEA, 0x8E, 0xCE, 0x7D, 0xC5,
        0xE1, 0xAC, 0x61, 0x2B
    };

    bigint_from_bytes(&a, a2, 16);
    bigint_from_bytes(&r, r2, 12);

    bigint_div_pow_2(&a, 32, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_div_pow_2_test - divide by 2^32 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_div_pow_2_test - divide by 2^32 failed");
    }

    unsigned char a3[] = {
        0x05, 0xAF, 0x65, 0xFB, 0xFE, 0xF0, 0x9D, 0x0F,
        0xC6, 0x24, 0xF2, 0x8A, 0x94, 0x3C, 0xFA, 0xA5,
        0xFB, 0x80
    };

    unsigned char r3[] = {
        0xB5
    };

    bigint_from_bytes(&a, a3, 18);
    bigint_from_bytes(&r, r3, 1);

    bigint_div_pow_2(&a, 131, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_div_pow_2_test - divide by 2^131 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_div_pow_2_test - divide by 2^131 failed");
    }
    
    bigint_free(&a);
    bigint_free(&c);
    bigint_free(&r);
    return failed;
}

int bigint_mod_pow_2_test(){
    int failed = 0;
    bigint a, c, r;
    int res = 0;

    unsigned char a1[] = {
        0x43, 0x4F, 0x09, 0x01, 0x72, 0x5C, 0x98, 0xFA,
        0x4E, 0x38, 0x4B, 0x9A, 0xC9, 0xAC, 0x2D, 0xF5
    };

    unsigned char r1[] = {
        0x09, 0xAC, 0x2D, 0xF5
    };

    bigint_init(&a, 1);
    bigint_init(&c, 1);
    bigint_init(&r, 1);

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&r, r1, 4);

    bigint_mod_pow_2(&a, 28, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mod_pow_2_test - mod 2^28 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mod_pow_2_test - mod 2^28 failed");
    }

    unsigned char a2[] = {
        0xD8, 0x21, 0x1D, 0x92, 0x65, 0x24, 0x9D, 0xAA,
        0xFE, 0xC9, 0xA9, 0xC2, 0xD6, 0x8C, 0x70
    };

    unsigned char r2[] = {
        0x29, 0xC2, 0xD6, 0x8C, 0x70
    };

    bigint_from_bytes(&a, a2, 15);
    bigint_from_bytes(&r, r2, 5);

    bigint_mod_pow_2(&a, 39, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mod_pow_2_test - mod 2^39 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mod_pow_2_test - mod 2^39 failed");
    }

    unsigned char a3[] = {
        0x6C, 0xEE, 0xEC, 0xEF, 0xCF, 0x9A, 0x29, 0x99,
        0xD8, 0xAD, 0xE7, 0xD9, 0x02, 0xD0, 0x88, 0x62,
        0xFF, 0xC6, 0xF0, 0x27, 0xEA, 0x3C, 0x86, 0xD1,
        0xFD, 0x8C, 0x6A, 0x3E, 0x78, 0x23, 0xB4, 0x5D
    };

    unsigned char r3[] = {
        0x6C, 0xEE, 0xEC, 0xEF, 0xCF, 0x9A, 0x29, 0x99,
        0xD8, 0xAD, 0xE7, 0xD9, 0x02, 0xD0, 0x88, 0x62,
        0xFF, 0xC6, 0xF0, 0x27, 0xEA, 0x3C, 0x86, 0xD1,
        0xFD, 0x8C, 0x6A, 0x3E, 0x78, 0x23, 0xB4, 0x5D
    };

    bigint_from_bytes(&a, a3, 32);
    bigint_from_bytes(&r, r3, 32);

    bigint_mod_pow_2(&a, 267, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mod_pow_2_test - mod 2^267 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mod_pow_2_test - mod 2^267 failed");
    }

    unsigned char r4[] = {
        0x01
    };

    bigint_from_bytes(&r, r4, 1);

    bigint_mod_pow_2(&a, 1, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mod_pow_2_test - mod 2^1 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mod_pow_2_test - mod 2^1 failed");
    }

    unsigned char r5[] = {
        0x00
    };
    
    bigint_from_bytes(&r, r5, 1);
    bigint_mod_pow_2(&a, 0, &c);
    res = bigint_cmp_zero(&c);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_mod_pow_2_test - mod 2^0 passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_mod_pow_2_test - mod 2^0 failed");
    }

    bigint_free(&a);
    bigint_free(&c);
    bigint_free(&r);
    return failed;
}

int bigint_div_test(){
    int failed = 0;
    bigint a, b, q, r, exp_r, exp_q;
    int res = 0;
    int div_res = 0;

    bigint_init(&a, 1); 
    bigint_init(&b, 1); 
    bigint_init(&q, 1); 
    bigint_init(&r, 1); 
    bigint_init(&exp_r, 1);
    bigint_init(&exp_q, 1);

    unsigned char a1[] = {
        0xEA, 0x58, 0xA7, 0x7F, 0x1A, 0x71, 0x3C, 0x8C,
        0xA7, 0xC7, 0x45, 0x99, 0xEC, 0x2E, 0x05, 0x45
    };

    unsigned char b1[] = {
        0x26, 0xE0, 0xA0, 0x7C, 0x3B, 0x31, 0x2A, 0xEB,
        0x5E, 0xD5, 0xB4, 0x7B, 0xC6, 0x33, 0x6E, 0xC8
    };

    unsigned char q1[] = {
        0x06
    };

    unsigned char r1[] = {
        0x01, 0x14, 0xE4, 0x95, 0xB7, 0x4A, 0x3B, 0x08,
        0x6E, 0xC5, 0x0A, 0xB3, 0x46, 0xF9, 0x6C, 0x95
    };

    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&b, b1, 16);
    bigint_from_bytes(&exp_q, q1, 1);
    bigint_from_bytes(&exp_r, r1, 16);

    div_res = bigint_div(&a, &b, &q, &r);
    res = bigint_cmp(&q, &exp_q);
    if(res == 0){
        bigint_print(&q, "q = ");
        print_passed("bigint_div quotient 1 - both bigints 128 bits passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&q, "q = ");
        bigint_print(&exp_q, "exp_q = ");
        print_failed("bigint_div quotient 1 - both bigints 128 bits failed");
    }

    res = bigint_cmp(&r, &exp_r);
    if(res == 0){
        bigint_print(&r, "r = ");
        print_passed("bigint_div remainder 1 - both bigints 128 bits passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&r, "r = ");
        bigint_print(&exp_r, "exp_r = ");
        print_failed("bigint_div remainder 1 - both bigints 128 bits failed");
    }

    unsigned char a2[] = {
        0xDC, 0x8C, 0x5B, 0xA2, 0x0B, 0x50, 0xB3, 0x7F,
        0x69, 0x9A, 0x3D, 0xB1, 0xCA, 0x9F, 0xEC, 0xAC
    };

    unsigned char b2[] = {
        0xCC, 0xE8, 0xD5, 0xC8, 0xB9, 0x79, 0x6B, 0x7A,
        0xD6, 0xF6, 0x94, 0xD3, 0x02, 0x23, 0x13
    };

    unsigned char q2[] = {
        0x01, 0x13
    };

    unsigned char r2[] = {
        0x6E, 0x3D, 0xFB, 0x6C, 0x13, 0x45, 0x0A, 0x74,
        0xAF, 0x5B, 0xD3, 0x1F, 0x54, 0x3F, 0x43
    };

    bigint_from_bytes(&a, a2, 16);
    bigint_from_bytes(&b, b2, 15);
    bigint_from_bytes(&exp_q, q2, 2);
    bigint_from_bytes(&exp_r, r2, 15);

    div_res = bigint_div(&a, &b, &q, &r);
    res = bigint_cmp(&q, &exp_q);
    if(res == 0){
        bigint_print(&q, "q = ");
        print_passed("bigint_div quotient 2 - 128 and 120 bits passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&q, "q = ");
        bigint_print(&exp_q, "exp_q = ");
        print_failed("bigint_div quotient 2 - 128 and 120 bits failed");
    }

    res = bigint_cmp(&r, &exp_r);
    if(res == 0){
        bigint_print(&r, "r = ");
        print_passed("bigint_div remainder 2 - 128 and 120 bits passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&r, "r = ");
        bigint_print(&exp_r, "exp_r = ");
        print_failed("bigint_div remainder 2 - 128 and 120 bits failed");
    }

    unsigned char a3[] = {
        0x40, 0x8B, 0x01, 0x51, 0x8C, 0xE4, 0xCE, 0x8D,
        0xED, 0x19, 0x6F, 0xFC, 0x94, 0x2B, 0x76, 0x1F
    };

    unsigned char b3[] = {
        0x15, 0x5C, 0x50, 0xD9, 0x97, 0x8E, 0x1A, 0x28
    };

    unsigned char q3[] = {
        0x03, 0x05, 0x86, 0xE2, 0x20, 0x71, 0x59, 0x40,
        0xED
    };

    unsigned char r3[] = {
        0x0D, 0x16, 0x31, 0xB4, 0xFF, 0x2B, 0x3F, 0x17
    };

    bigint_from_bytes(&a, a3, 16);
    bigint_from_bytes(&b, b3, 8);
    bigint_from_bytes(&exp_q, q3, 9);
    bigint_from_bytes(&exp_r, r3, 8);

    div_res = bigint_div(&a, &b, &q, &r);
    res = bigint_cmp(&q, &exp_q);
    if(res == 0){
        bigint_print(&q, "q = ");
        print_passed("bigint_div quotient 3 - 128 and 64 bits passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&q, "q = ");
        bigint_print(&exp_q, "exp_q = ");
        print_failed("bigint_div quotient 3 - 128 and 64 bits failed");
    }

    res = bigint_cmp(&r, &exp_r);
    if(res == 0){
        bigint_print(&r, "r = ");
        print_passed("bigint_div remainder 3 - 128 and 64 bits passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&r, "r = ");
        bigint_print(&exp_r, "exp_r = ");
        print_failed("bigint_div remainder 3 - 128 and 64 bits failed");
    }

    unsigned char a4[] = {
        0x47, 0x49, 0xBB, 0x20, 0x7A, 0x4D, 0x0F, 0x28,
        0x0D, 0x6D, 0xC8, 0xBC, 0x2E, 0x1A, 0x3D, 0x87,
        0x00, 0xC7, 0xAB, 0x88, 0x71, 0xBC, 0xE0, 0xBF,
        0xE2, 0x54, 0x98, 0x90, 0xB2, 0x1F, 0x4F, 0x5E,
        0xFD, 0x72, 0xF9, 0xF3, 0x2B, 0x4A, 0x52, 0x57,
        0x87, 0x92, 0x5A, 0xC7, 0x6B, 0xED, 0x1D, 0x37,
        0x93, 0xE2, 0xAF, 0xB2, 0x32, 0x14, 0x3F, 0x8B,
        0x18, 0xB5, 0xD6, 0xF5, 0xA3, 0xDC, 0xDC, 0xBB
    };

    unsigned char b4[] = {
        0xB6, 0xD3, 0x4A, 0x6E, 0x21, 0x02, 0x92, 0x23,
        0x00, 0xFC, 0x86, 0xBB, 0x9E, 0x28, 0x63, 0x69,
        0x19, 0xCE, 0xED, 0x17, 0x05, 0x32, 0x30, 0x44,
        0xB7, 0x9C, 0x56, 0x7D, 0xB5, 0xE4, 0x16, 0x05
    };

    unsigned char q4[] = {
        0x63, 0xD2, 0x10, 0xD4, 0x50, 0x9C, 0x0A, 0x28,
        0xC5, 0x0C, 0x22, 0x55, 0x59, 0xCE, 0x98, 0x4F,
        0x96, 0x3D, 0xAB, 0xA8, 0xDE, 0xC2, 0x51, 0xFE,
        0x71, 0xE9, 0xF1, 0x62, 0x3B, 0x79, 0xEC, 0x06
    };

    unsigned char r4[] = {
        0x4F, 0x9D, 0xDF, 0xC1, 0x0D, 0x53, 0x96, 0xC2,
        0x94, 0xEC, 0x77, 0x5E, 0x3B, 0x4C, 0xDC, 0x48,
        0x3F, 0x15, 0x94, 0x63, 0xD1, 0x92, 0xD7, 0x35,
        0x37, 0x61, 0x3F, 0x89, 0x8C, 0xDA, 0xBC, 0x9D
    };

    bigint_from_bytes(&a, a4, 64);
    bigint_from_bytes(&b, b4, 32);
    bigint_from_bytes(&exp_q, q4, 32);
    bigint_from_bytes(&exp_r, r4, 32);

    div_res = bigint_div(&a, &b, &q, &r);
    res = bigint_cmp(&q, &exp_q);
    if(res == 0){
        bigint_print(&q, "q = ");
        print_passed("bigint_div quotient 4 - 512 and 256 bits passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&q, "q = ");
        bigint_print(&exp_q, "exp_q = ");
        print_failed("bigint_div quotient 4 - 512 and 256 bits failed");
    }

    res = bigint_cmp(&r, &exp_r);
    if(res == 0){
        bigint_print(&r, "r = ");
        print_passed("bigint_div remainder 4 - 512 and 256 bits passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&r, "r = ");
        bigint_print(&exp_r, "exp_r = ");
        print_failed("bigint_div remainder 4 - 512 and 256 bits failed");
    }

    unsigned char a5[] = {
        0x3F, 0xEC, 0x3E, 0x0A, 0x41, 0x3C, 0xD2, 0xAE,
        0x69, 0xB0, 0xB3, 0xAD, 0xDD, 0xFA, 0xCF, 0xFB
    };

    unsigned char b5[] = {
        0x03, 0xBD, 0x38, 0x2D, 0x41, 0xE1, 0x1B, 0x7D,
        0x9E, 0x88, 0xA2, 0x69, 0x0B, 0xBD, 0x98, 0x9D,
        0x29
    };

    unsigned char q5[] = {
        0x00
    };

    unsigned char r5[] = {
        0x3F, 0xEC, 0x3E, 0x0A, 0x41, 0x3C, 0xD2, 0xAE,
        0x69, 0xB0, 0xB3, 0xAD, 0xDD, 0xFA, 0xCF, 0xFB
    };

    bigint_from_bytes(&a, a5, 16);
    bigint_from_bytes(&b, b5, 17);
    bigint_from_bytes(&exp_q, q5, 1);
    bigint_from_bytes(&exp_r, r5, 16);

    div_res = bigint_div(&a, &b, &q, &a);
    res = bigint_cmp(&q, &exp_q);
    if(res == 0){
        bigint_print(&q, "q = ");
        print_passed("bigint_div quotient 5 - 128 and 130 bits passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&q, "q = ");
        bigint_print(&exp_q, "exp_q = ");
        print_failed("bigint_div quotient 5 - 128 and 130 bits failed");
    }

    res = bigint_cmp(&a, &exp_r);
    if(res == 0){
        bigint_print(&r, "r = ");
        print_passed("bigint_div remainder 5 - 128 and 130 bits passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&r, "r = ");
        bigint_print(&exp_r, "exp_r = ");
        print_failed("bigint_div remainder 5 - 128 and 130 bits failed");
    }

    unsigned char a6[] = {
        0xC3, 0xE7, 0x0B, 0x03, 0x72, 0x1D, 0xB1, 0x33,
        0x2E, 0xFE, 0x6F, 0xF0, 0xC9, 0x9A, 0xD8, 0xF9,
        0xFB, 0xD1, 0x2E, 0x85, 0xE3, 0x69, 0x00, 0xC1,
        0x23, 0x7E, 0x3E, 0x36, 0xE4, 0xDE, 0x42, 0x1F,
        0x98, 0x01, 0x49, 0x3B, 0x12, 0xB9, 0x50, 0x6D,
        0x96, 0xFE, 0x82, 0x61, 0x0E, 0x4F, 0xF3, 0xFA,
        0xD8, 0x71, 0xA3, 0x3B, 0x39, 0x21, 0x04, 0x8C,
        0x31, 0x17, 0xDC, 0x25, 0xEE, 0x86, 0xF8, 0x0B,
        0x87, 0x45, 0x99, 0xA6, 0x0F, 0x5C, 0xBB, 0xC7,
        0x49, 0xA4, 0x68, 0x5B, 0x39, 0x60, 0x22, 0x19,
        0x22, 0xFC, 0x69, 0x7C, 0xF4, 0xCF, 0x16, 0xF0,
        0x87, 0x56, 0x8B, 0xFC, 0xF0, 0x20, 0xA7, 0x5B,
        0x0B, 0x64, 0x15, 0x19, 0x6B, 0xAF, 0xB4, 0x69,
        0x92, 0x1E, 0xC2, 0x7F, 0xD3, 0x3D, 0xDD, 0xEF,
        0xE4, 0x25, 0x49, 0x41, 0x3D, 0xD9, 0xF6, 0x33,
        0xF3, 0x54, 0xD7, 0x1C, 0xCF, 0xA3, 0x0A, 0x3D
    };

    unsigned char b6[] = {
        0x01, 0x7D, 0x9F, 0x68, 0x66, 0xC7, 0x37, 0x95,
        0x63, 0xF4, 0x39, 0xC1, 0x74, 0x05, 0xDD, 0x9E,
        0x39, 0x30, 0xE2, 0xA5, 0x6D, 0x7F, 0xBE, 0x07,
        0x4A, 0x6D, 0x07, 0xBF, 0xD9, 0x7A, 0x93, 0x9B,
        0x7B, 0x29, 0x2A, 0xDE, 0x44, 0x6E, 0x39, 0xF8,
        0x9A, 0xE7, 0x6A, 0x91, 0x42, 0x64, 0x62, 0xD7,
        0xEE, 0x6A, 0xC2, 0x6B, 0x27, 0x1D, 0x61, 0x38,
        0x4B, 0x3B, 0xA6, 0xD9, 0xBD, 0xE8, 0xBB, 0x54
    };

    unsigned char q6[] = {
        0x83, 0x6A, 0x4E, 0x35, 0x07, 0xEB, 0x1A, 0x8C,
        0x4F, 0x2D, 0xC9, 0x56, 0xD9, 0x12, 0xBB, 0xED,
        0x45, 0xF6, 0x8A, 0x07, 0x89, 0x8C, 0xD0, 0x65,
        0xE3, 0xA7, 0xDC, 0x59, 0x3C, 0x31, 0x65, 0xD7,
        0x9C, 0x94, 0xD6, 0x2B, 0xEB, 0x6F, 0x84, 0x7C,
        0xED, 0x57, 0x07, 0x18, 0x82, 0xCD, 0xBA, 0x83,
        0x08, 0x7E, 0x30, 0x10, 0xC1, 0x90, 0x20, 0x85,
        0xF3, 0x54, 0xDE, 0x68, 0x00, 0x4D, 0x0A, 0x31,
        0xB7
    };

    unsigned char r6[] = {
        0x08, 0x0E, 0xCD, 0x22, 0x82, 0xFE, 0x4A, 0x4E,
        0xE7, 0x0B, 0xF8, 0xBF, 0x40, 0xB0, 0xD9, 0xE8,
        0x64, 0x51, 0x60, 0xA4, 0xDE, 0xEF, 0xF5, 0x93,
        0x4A, 0x03, 0x23, 0x0B, 0x83, 0x95, 0xDC, 0x6B,
        0x2D, 0x7C, 0x6D, 0xC9, 0xF9, 0xC1, 0xFF, 0x55,
        0xE5, 0x96, 0x7C, 0xB4, 0x10, 0x7B, 0xB5, 0x8F,
        0x67, 0x1E, 0x99, 0xB6, 0xC1, 0xD7, 0xDF, 0x2F,
        0x2E, 0x58, 0xAC, 0xED, 0x22, 0x0D, 0x31
    };

    bigint_from_bytes(&a, a6, 16 * 8);
    bigint_from_bytes(&b, b6, 64);
    bigint_from_bytes(&exp_q, q6, 65);
    bigint_from_bytes(&exp_r, r6, 63);

    div_res = bigint_div(&a, &b, &q, &a);
    res = bigint_cmp(&q, &exp_q);
    if(res == 0){
        bigint_print(&q, "q = ");
        print_passed("bigint_div quotient 6 - large number passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&q, "q = ");
        bigint_print(&exp_q, "exp_q = ");
        print_failed("bigint_div quotient 6 - large number failed");
    }

    res = bigint_cmp(&a, &exp_r);
    if(res == 0){
        bigint_print(&r, "r = ");
        print_passed("bigint_div remainder 6 - large number passed");
    } else{
        failed = 1;
        if(div_res == 8){
            printf("divide by 0\n");
        }
        printf("error code = %d\n", div_res);
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&r, "r = ");
        bigint_print(&exp_r, "exp_r = ");
        print_failed("bigint_div remainder 6 - large number failed");
    }

    bigint_free(&a);
    bigint_free(&b);
    bigint_free(&r);
    bigint_free(&q);
    bigint_free(&exp_q);
    bigint_free(&exp_r);
    return failed;

}

int bigint_mod_test(){
    int failed = 0;
    int res = 0;
    bigint a, b, c, r;

    unsigned char a1[] = {
        0xC9, 0x36, 0x69, 0xBF, 0xDD, 0x07, 0xED, 0x94,
        0x2A, 0x78, 0x8C, 0xCB, 0xE4, 0x16, 0x27, 0xE2
    };

    unsigned char b1[] = {
        0x1F, 0xE7, 0xB8, 0x3A, 0x46, 0x77, 0x52, 0xE2,
        0x44, 0xB6, 0x33, 0x24, 0x93, 0x32, 0xBE, 0xDF
    };

    unsigned char r1[] = {
        0x09, 0xC8, 0x18, 0x62, 0x36, 0x3B, 0xFC, 0x46,
        0x8E, 0x33, 0x59, 0xF0, 0x70, 0xE5, 0xAE, 0xA8
    };

    bigint_init(&a, 4);
    bigint_init(&b, 4);
    bigint_init(&c, 4);
    bigint_init(&r, 4);
    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&b, b1, 16);
    bigint_from_bytes(&r, r1, 16);

    bigint_mod(&a, &b, &a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "r = ");
        print_passed("bigint_mod_test  1 - passed");
    } else{
        failed = 1;
        printf("divide by 0\n");
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "r = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_mod_test  1 - failed");
    }

    unsigned char a2[] = {
        0x2D, 0xE1, 0x2D, 0xDA, 0x41, 0xCD, 0x32, 0x92,
        0xC0, 0x08, 0x73, 0x43, 0x6D, 0xF2, 0xC8, 0x0E,
        0x3B, 0xF6, 0x92, 0x00, 0xFB, 0x04, 0x91, 0x9A,
        0xAF, 0xD8, 0x2C, 0x89, 0x6E, 0x15, 0x17, 0xC3,
        0xF5, 0x8D, 0x54, 0x54, 0x40, 0x83, 0x25, 0x06,
        0x37, 0x64, 0xB6, 0x66, 0x88, 0xD0, 0x49, 0x4F,
        0xA0, 0x64, 0xB2, 0xF9, 0x72, 0x7D, 0xB8, 0x78,
        0x88, 0xC3, 0xBD, 0x4A, 0xC9, 0xA1, 0x82, 0x94,
        0x69, 0xBB, 0x07, 0xA6, 0xB0, 0x69, 0xBE, 0xA5,
        0x89, 0xEF, 0x2C, 0xC1, 0xD5, 0x2C, 0x5F, 0x68,
        0x12, 0xF1, 0x66, 0xAC, 0x74, 0xEB, 0x6A, 0x4C,
        0xDB, 0x3E, 0x54, 0x22, 0x8D, 0x7F, 0xD5, 0x69,
        0x0E, 0x40, 0x70, 0xAC, 0xAF, 0xC4, 0x1D, 0xF6,
        0x24, 0x49, 0xB5, 0xDA, 0x39, 0xDE, 0x7D, 0x47,
        0xF1, 0xEB, 0x9E, 0x33, 0x4B, 0xAE, 0x43, 0x9E,
        0xD0, 0x77, 0x95, 0xBC, 0x67, 0x33, 0x12, 0xFB,
        0x20, 0xC2, 0xBE, 0xB9, 0xFE, 0x1D, 0x15, 0x62,
        0xAC, 0xF3, 0x57, 0x22, 0x33, 0x44, 0xA5, 0x40,
        0x7A, 0x05, 0xE5, 0x03, 0x9D, 0x93, 0x96, 0x21,
        0x06, 0xB6, 0xC6, 0xB3, 0x81, 0x98, 0xC2, 0x7E,
        0x75, 0xF9, 0x72, 0x34, 0xF1, 0xAE, 0x5C, 0x79,
        0x0D, 0x2D, 0x5D, 0x30, 0xD2, 0xD3, 0xA0, 0xB3,
        0x4C, 0xA6, 0x51, 0x18, 0xFB, 0x66, 0x1E, 0x7B,
        0xDC, 0x4C, 0xF1, 0x45, 0x9F, 0x71, 0x12, 0xA4,
        0x1C, 0x94, 0xFD, 0x4D, 0xDC, 0x7A, 0xD6, 0x45,
        0x08, 0xAE, 0x1D, 0x79, 0x7C, 0xF1, 0xAE, 0x3B,
        0x8B, 0xD7, 0xAE, 0x25, 0x4E, 0xC9, 0xB6, 0x61,
        0x16, 0xE5, 0x27, 0xDE, 0x31, 0x1B, 0x32, 0x21,
        0xB6, 0xE5, 0x1A, 0x2C, 0x14, 0xF4, 0x89, 0x1B,
        0xE6, 0xDA, 0x10, 0x7B, 0xAC, 0x63, 0xA1, 0xF7,
        0x6C, 0x1C, 0x41, 0xF4, 0xEC, 0x37, 0x8F, 0x11,
        0x6C, 0xCF, 0xFB, 0xA5, 0x5E, 0x79, 0x00, 0x8D
    };

    unsigned char b2[] = {
        0x76, 0xBA, 0xB1, 0x91, 0x18, 0x7D, 0x9E, 0x7E,
        0x32, 0xE8, 0x3F, 0x68, 0xA9, 0xFF, 0x1E, 0x68,
        0x41, 0x14, 0x8A, 0x81, 0xB9, 0xD4, 0x12, 0x97,
        0xC9, 0xA7, 0x58, 0x68, 0x9E, 0xF7, 0x0B, 0x90,
        0x60, 0x79, 0x15, 0x72, 0xE4, 0x1F, 0x0C, 0x14,
        0x8A, 0xA0, 0xB9, 0xA2, 0xBE, 0x23, 0xCB, 0x80,
        0x48, 0x8E, 0xB7, 0x32, 0x84, 0xF7, 0x1A, 0x29,
        0xD3, 0xC6, 0x0E, 0x41, 0x77, 0x33, 0xB6, 0xD5
    };

    unsigned char r2[] = {
        0x63, 0xCB, 0xC1, 0x3C, 0xEB, 0x89, 0xE1, 0x1D,
        0x44, 0xBC, 0x14, 0x17, 0xAC, 0xFB, 0x86, 0xB1,
        0x5F, 0xB5, 0xE3, 0x8F, 0x35, 0xD5, 0x11, 0x45,
        0xA3, 0xFB, 0xE8, 0x50, 0x66, 0xCA, 0x3F, 0xEE,
        0xCA, 0x4F, 0x52, 0x74, 0xEA, 0xF8, 0x8E, 0x90,
        0x22, 0x26, 0x1B, 0x30, 0x79, 0x52, 0x9A, 0xEF,
        0x7A, 0xEB, 0x6F, 0xA5, 0x9B, 0x13, 0x8D, 0xD2,
        0xC3, 0xE7, 0xF1, 0x85, 0xCF, 0xA6, 0xF7, 0xC0
    };

    bigint_from_bytes(&a, a2, 256);
    bigint_from_bytes(&b, b2, 64);
    bigint_from_bytes(&r, r2, 64);

    bigint_mod(&a, &b, &a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "r = ");
        print_passed("bigint_mod_test  2 - passed");
    } else{
        failed = 1;
        printf("divide by 0\n");
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "r = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_mod_test  2 - failed");
    }

    bigint_free(&a);
    bigint_free(&b);
    bigint_free(&r);
    bigint_free(&c);

    return failed;
}

int bigint_mul_mod_test(){
    int failed = 0;
    int res = 0;
    bigint a, b, m, c, r;

    unsigned char a1[] = {
        0xC6, 0x7C, 0x8A, 0x6A, 0xC6, 0x82, 0x35, 0x47,
        0x7A, 0xF1, 0x41, 0xEC, 0xDB, 0x31, 0x22, 0xD2
    };

    unsigned char b1[] = {
        0x8B, 0xCB, 0x83, 0x44, 0x28, 0xED, 0x42, 0xDF,
        0xFD, 0x5F, 0xCE, 0xF3, 0x54, 0xF8, 0x46, 0xB0
    };

    unsigned char m1[] = {
        0x28, 0xAD, 0xD7, 0xE5, 0xB9, 0xAB, 0x41, 0xBC,
        0xCA, 0x76, 0xFA, 0x06, 0x66, 0x6F, 0x56, 0xFF
    };

    unsigned char r1[] = {
        0x12, 0x10, 0xD8, 0xF6, 0x55, 0x5B, 0xB2, 0xC9,
        0x5A, 0x2F, 0x94, 0x5B, 0x27, 0x53, 0x93, 0x32
    };

    bigint_init(&a, 4);
    bigint_init(&b, 4);
    bigint_init(&c, 4);
    bigint_init(&m, 4);
    bigint_init(&r, 4);
    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&b, b1, 16);
    bigint_from_bytes(&m, m1, 16);
    bigint_from_bytes(&r, r1, 16);

    bigint_mul_mod(&a, &b, &m, &a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "r = ");
        print_passed("bigint_mul_mod_test  1 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");     
        bigint_print(&m, "m = ");     
        bigint_print(&a, "r = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_mul_mod_test  1 - failed");
    }

    unsigned char a2[] = {
        0x05, 0xF6, 0x36, 0x0C, 0x10, 0xCC, 0x24, 0x7F,
        0x60, 0x37, 0x03, 0xEF, 0x5A, 0x5E, 0xD4, 0xC5,
        0x33, 0xC5
    };

    unsigned char b2[] = {
        0x3B, 0xDC, 0x0E, 0xAC, 0xC7, 0xD1, 0xD0, 0xD8,
        0x2A, 0x7E, 0xE8, 0xAC, 0x4E, 0x50, 0xAE
    };

    unsigned char m2[] = {
        0x1D, 0xFB, 0x97, 0x94, 0xEA, 0x6E, 0xD4, 0x97,
        0x60, 0xA6, 0x7F, 0xC9, 0x92, 0xAE, 0x5A, 0x12
    };

    unsigned char r2[] = {
        0x0F, 0xE0, 0xB5, 0xB4, 0xB0, 0xFF, 0xE5, 0x05,
        0x67, 0x45, 0x30, 0x90, 0xF2, 0xA9, 0x91, 0x7E
    };

    bigint_from_bytes(&a, a2, 18);
    bigint_from_bytes(&b, b2, 15);
    bigint_from_bytes(&m, m2, 16);
    bigint_from_bytes(&r, r2, 16);

    bigint_mul_mod(&a, &b, &m, &a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "r = ");
        print_passed("bigint_mul_mod_test  2 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");     
        bigint_print(&m, "m = ");     
        bigint_print(&a, "r = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_mul_mod_test  2 - failed");
    }

    unsigned char a3[] = {
        0x06, 0x1D, 0x29, 0xC0, 0x5B, 0xAA, 0xF3, 0x71,
        0x0E, 0x25, 0xA9, 0x20, 0xA4, 0x6B, 0x2E, 0x84,
        0xCF, 0x0A
    };

    unsigned char b3[] = {
        0x9B, 0xD7
    };

    unsigned char m3[] = {
        0x01, 0x71, 0xE3, 0x09
    };

    unsigned char r3[] = {
        0x01, 0x66, 0xC8, 0x02
    };

    bigint_from_bytes(&a, a3, 18);
    bigint_from_bytes(&b, b3, 2);
    bigint_from_bytes(&m, m3, 4);
    bigint_from_bytes(&r, r3, 4);

    bigint_mul_mod(&a, &b, &m, &a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "r = ");
        print_passed("bigint_mul_mod_test  3 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");     
        bigint_print(&m, "m = ");     
        bigint_print(&a, "r = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_mul_mod_test  3 - failed");
    }

    unsigned char a4[] = {
        0x13, 0x14, 0xF8, 0x56, 0x2E, 0x70, 0x62, 0x47,
        0x17, 0x1B, 0x66, 0xF7, 0xBF, 0x37, 0x77, 0xAD,
        0x80, 0x00, 0xC0, 0x8A, 0xF6, 0x2A, 0xB5, 0x0F,
        0xFA, 0x77, 0xA8, 0x52, 0x15, 0xBB, 0x3C, 0xC4,
        0x5C, 0x6F, 0x44, 0xF1, 0x48, 0x4A, 0xD9, 0xBC,
        0x2C, 0x6A, 0x92, 0xD3, 0xF4, 0x7B, 0x04, 0xFD,
        0xF3, 0x42, 0xCC, 0x96, 0x2E, 0x2A, 0xBA, 0x4A,
        0x41, 0x22, 0xAD, 0xC0, 0x30, 0x49, 0x00, 0xFC,
        0xBF, 0xA8, 0x6E, 0xA6, 0x68, 0x7D, 0x34, 0x62,
        0x0B, 0x6C, 0xEE, 0x67, 0x3F, 0xE2, 0xEE, 0x37,
        0x52, 0xC4, 0xAE, 0xCC, 0x53, 0xB7, 0x89, 0x3A,
        0x65, 0xFB, 0x01, 0x91, 0x14, 0x37, 0xD7, 0xEF,
        0x88, 0xC6, 0xC2, 0x8F, 0xB2, 0x60, 0x1F, 0x16,
        0x91, 0x20, 0x2C, 0xA5, 0x18, 0x23, 0x8D, 0x85,
        0x85, 0x23, 0x12, 0xD1, 0x2C, 0xA9, 0xE2, 0x43,
        0xAA, 0xEB, 0xFF, 0x95, 0x69, 0xC1, 0x6B, 0x60
    };

    unsigned char b4[] = {
        0x51, 0xE7, 0xBD, 0x6F, 0x02, 0x29, 0x9D, 0x5C,
        0xA4, 0xD2, 0x79, 0x34, 0x3A, 0x3C, 0xE3, 0x94,
        0xF4, 0xC4, 0xC1, 0xD4, 0x31, 0xE4, 0x4B, 0xA9,
        0x8D, 0x4B, 0x31, 0x7B, 0xBA, 0x83, 0x05, 0x76,
        0x22, 0x11, 0xE1, 0x7F, 0xD0, 0x40, 0x1F, 0xEB,
        0x72, 0x07, 0x8E, 0x98, 0xD0, 0xB8, 0x7D, 0x7D,
        0x43, 0x76, 0xD0, 0x33, 0x4F, 0x9C, 0xE6, 0x74,
        0x28, 0x1C, 0x11, 0xDD, 0xBD, 0xE1, 0x12, 0x72,
        0x01, 0xB5, 0x74, 0x2F, 0x4C, 0x47, 0xB1, 0x89,
        0x70, 0x4D, 0x01, 0xC2, 0xEF, 0x87, 0xD9, 0x0A,
        0xAB, 0xEC, 0x64, 0x0E, 0x27, 0x66, 0x6F, 0x6D,
        0xF3, 0x27, 0xB2, 0x38, 0x66, 0x89, 0xCF, 0x7D,
        0x84, 0x46, 0xBD, 0x38, 0x61, 0xEB, 0x68, 0x5D,
        0x5D, 0xDB, 0x06, 0xE4, 0x87, 0xED, 0x0C, 0x53,
        0x75, 0x0D, 0x7A, 0x0E, 0x54, 0x1D, 0x3D, 0x48,
        0xEC, 0x05, 0x2E, 0x7D, 0xF8, 0xA3, 0xE7, 0xF3
    };

    unsigned char m4[] = {
        0xBD, 0xF4, 0x15, 0xEA, 0x98, 0x2B, 0x3C, 0xF2,
        0xC1, 0x02, 0x2E, 0xD6, 0x50, 0x0F, 0x0A, 0xD9,
        0xA2, 0x06, 0x79, 0x65, 0x50, 0x51, 0x70, 0xBA,
        0x25, 0x62, 0x82, 0x97, 0x64, 0xBC, 0xA1, 0x22,
        0x4B, 0xB6, 0x05, 0xB5, 0xE8, 0x83, 0x92, 0xB3,
        0xEB, 0xA5, 0xF6, 0xA3, 0xDD, 0x40, 0x0E, 0xA9,
        0x3D, 0x3F, 0x70, 0x12, 0xDF, 0x5C, 0x18, 0xB2,
        0x42, 0x1B, 0x66, 0xE3, 0x4E, 0x43, 0x62, 0x43,
        0x7E, 0x39, 0xB8, 0xE2, 0x48, 0x4F, 0x91, 0xBF,
        0x8E, 0x84, 0x47, 0xCA, 0x5D, 0x48, 0x05, 0xDC,
        0xED, 0x41, 0xC9, 0x23, 0xED, 0x39, 0x89, 0x6D,
        0x62, 0x4B, 0x5A, 0xCC, 0xC1, 0x2B, 0xAD, 0x5C,
        0x5E, 0x60, 0x7A, 0x3A, 0x80, 0x69, 0xB4, 0x20,
        0xE4, 0x83, 0x16, 0xCC, 0xE8, 0x0D, 0xC5, 0xB9,
        0x86, 0x45, 0xB6, 0xF4, 0x4B, 0xDA, 0x77, 0x91,
        0xB5, 0x73, 0xA8, 0x13, 0xBF, 0x6F, 0x9A, 0xC2
    };

    unsigned char r4[] = {
        0x3D, 0xB0, 0xD4, 0x75, 0x06, 0xC3, 0x53, 0x3C,
        0xFA, 0x36, 0x50, 0xA0, 0xD8, 0x37, 0x66, 0xCA,
        0xCA, 0x4D, 0x6C, 0xED, 0xF8, 0x48, 0xBD, 0x9D,
        0xFB, 0xBB, 0xD8, 0xD5, 0x5A, 0x79, 0x1B, 0x35,
        0x78, 0x62, 0x01, 0x2F, 0x16, 0x7B, 0xAF, 0xC8,
        0x0B, 0x69, 0xE9, 0x7B, 0xD3, 0xED, 0xE8, 0x56,
        0xC8, 0xFB, 0x6F, 0x74, 0xFB, 0x6B, 0x73, 0x55,
        0x6D, 0x15, 0x8D, 0x28, 0x1C, 0x3B, 0x02, 0xCF,
        0x2A, 0x30, 0xA1, 0x94, 0x51, 0x34, 0xEC, 0xCE,
        0x19, 0x94, 0xF1, 0x77, 0xF2, 0xBA, 0xA2, 0xC8,
        0xEF, 0x18, 0x47, 0xFC, 0xB7, 0x37, 0xA4, 0x10,
        0x3D, 0x86, 0x4C, 0x99, 0x68, 0xB9, 0xB0, 0xB5,
        0xEC, 0x3E, 0x87, 0x80, 0x7F, 0xC8, 0x32, 0xD3,
        0xEA, 0x32, 0xB8, 0x79, 0xD0, 0x97, 0x60, 0xD3,
        0x12, 0x69, 0x8F, 0x50, 0x22, 0x72, 0xCD, 0xEF,
        0x7E, 0xB8, 0xAD, 0x2D, 0x15, 0x9B, 0xDF, 0xD0
    };

    bigint_from_bytes(&a, a4, 128);
    bigint_from_bytes(&b, b4, 128);
    bigint_from_bytes(&m, m4, 128);
    bigint_from_bytes(&r, r4, 128);

    bigint_mul_mod(&a, &b, &m, &a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "r = ");
        print_passed("bigint_mul_mod_test  4 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");     
        bigint_print(&m, "m = ");     
        bigint_print(&a, "r = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_mul_mod_test  4 - failed");
    }

    bigint_free(&a);
    bigint_free(&b);
    bigint_free(&r);
    bigint_free(&m);
    bigint_free(&c);

    return failed;
}

int bigint_square_mod_test(){
    int failed = 0;
    int res = 0;
    bigint a, m, c, r;

    unsigned char a1[] = {
        0x4F, 0xEA, 0xAE, 0xD4, 0x9B, 0x6A, 0xA5, 0x36,
        0x29, 0x17, 0x59, 0xD7, 0xEA, 0x13, 0x66, 0xA7
    };

    unsigned char m1[] = {
        0xF6, 0x13, 0xC2, 0x3C, 0xD8, 0x95, 0x4B, 0xBB,
        0xB3, 0x58, 0xF8, 0x3B, 0xE6, 0xF3, 0x08, 0xF9
    };

    unsigned char r1[] = {
        0x7B, 0xCE, 0x2F, 0x0A, 0x83, 0x37, 0x34, 0x16,
        0x7B, 0x4D, 0x83, 0xC2, 0x90, 0x3A, 0xD7, 0x1C
    };

    bigint_init(&a, 4);
    bigint_init(&c, 4);
    bigint_init(&m, 4);
    bigint_init(&r, 4);
    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&m, m1, 16);
    bigint_from_bytes(&r, r1, 16);

    bigint_square_mod(&a, &m, &a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "r = ");
        print_passed("bigint_square_mod_test  1 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&m, "m = ");     
        bigint_print(&a, "r = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_square_mod_test  1 - failed");
    }

    unsigned char a2[] = {
        0x56, 0xFC, 0x0E, 0x66, 0x33, 0x9B, 0x0D, 0x2C,
        0x90, 0xFD, 0x0C, 0x2F, 0x68, 0x12, 0xC5, 0x68,
        0x08, 0x18, 0x05, 0xDC, 0x70, 0x77, 0xE2, 0x0B,
        0x9E, 0xB8, 0x9F, 0xD3, 0x6C, 0x93, 0xE5, 0x51
    };

    unsigned char m2[] = {
        0x38, 0x6C, 0x3C, 0x0F, 0xA2
    };

    unsigned char r2[] = {
        0x14, 0x5A, 0x41, 0xA8, 0xEF
    };

    bigint_from_bytes(&a, a2, 32);
    bigint_from_bytes(&m, m2, 5);
    bigint_from_bytes(&r, r2, 5);

    bigint_square_mod(&a, &m, &a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "r = ");
        print_passed("bigint_square_mod_test  2 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&m, "m = ");     
        bigint_print(&a, "r = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_square_mod_test  2 - failed");
    }

    unsigned char a3[] = {
        0x82, 0x04, 0x44, 0x4C, 0xB4, 0xF3, 0xF3, 0xD7,
        0x92, 0x38, 0x49, 0x57, 0x20, 0xBA, 0x84, 0x72,
        0xF7, 0x42, 0x13, 0x8C, 0x31, 0x38, 0xCB, 0xBF,
        0x32, 0x70, 0x60, 0x76, 0x4F, 0x07, 0x49, 0x92,
        0x67, 0xF4, 0x30, 0xD3, 0xB7, 0xE8, 0x97, 0xFC,
        0xF1, 0xD6, 0x86, 0x58, 0x83, 0xA7, 0xD6, 0x4B,
        0x3C, 0xDC, 0x84, 0x4B, 0x94, 0xE2, 0xAF, 0xCD,
        0x37, 0x6B, 0x24, 0x18, 0xF9, 0x05, 0x18, 0x36,
        0xB7, 0x36, 0xBD, 0x40, 0xB8, 0xA8, 0x52, 0x3F,
        0x28, 0x0E, 0x94, 0xC6, 0x26, 0xD8, 0xD8, 0x08,
        0xF2, 0x5A, 0x32, 0x17, 0x2D, 0x35, 0x1A, 0x6B,
        0x2B, 0x78, 0xCB, 0x3E, 0xAB, 0x0F, 0x88, 0x48,
        0xD5, 0x2D, 0x69, 0xE0, 0x14, 0xBF, 0x41, 0x02,
        0xA5, 0xF5, 0xDF, 0xEA, 0x8B, 0x50, 0x65, 0x67,
        0x5B, 0x36, 0xE6, 0xB0, 0x2F, 0xC6, 0x66, 0x55,
        0x7E, 0x90, 0xEB, 0xFE, 0x0E, 0x69, 0xE3, 0xE2,
        0x9B, 0xB7, 0x07, 0x03, 0x50, 0xCE, 0xC9, 0x67,
        0xE1, 0x56, 0xEB, 0x8E, 0x28, 0xD7, 0x29, 0xFF,
        0xA3, 0x7A, 0x35, 0xEA, 0x4A, 0x6F, 0x94, 0x1C,
        0x1E, 0xDD, 0x0F, 0xE3, 0x79, 0xA1, 0x88, 0x1A,
        0xCA, 0xB4, 0x98, 0x60, 0xF6, 0xA5, 0x4E, 0x05,
        0x9B, 0x0F, 0x0C, 0x03, 0xA7, 0x6C, 0x6B, 0x84,
        0x43, 0x8E, 0xAB, 0x2C, 0x2E, 0xD5, 0xD2, 0x50,
        0x97, 0x5B, 0xE1, 0xA5, 0x98, 0x2A, 0xF2, 0xCD,
        0xCE, 0x44, 0xF2, 0x36, 0x53, 0xD3, 0x76, 0xCD,
        0x43, 0x65, 0x9C, 0x9F, 0xC4, 0x57, 0xF6, 0xD2,
        0xAA, 0xAE, 0xED, 0xFC, 0xF3, 0x77, 0x48, 0x33,
        0x39, 0x6E, 0x4C, 0x20, 0x2C, 0x8F, 0x3E, 0x1B,
        0x94, 0xE2, 0xA8, 0xD6, 0x58, 0x78, 0x1E, 0x71,
        0x67, 0x6D, 0x79, 0x54, 0x27, 0xC5, 0x5E, 0x01,
        0x0C, 0x43, 0x5D, 0xA0, 0xF6, 0x22, 0x43, 0x7C,
        0x9E, 0x48, 0xB7, 0x3D, 0xFF, 0x8F, 0xEB, 0x8B
    };

    unsigned char m3[] = {
        0x0A, 0xE8, 0x6E, 0xA4, 0xC8, 0x58, 0x64, 0xA4,
        0xE9, 0x91, 0x18, 0xBC, 0xF1, 0x5B, 0x5E, 0x08,
        0x69, 0x53, 0x22, 0x6D, 0x55, 0x89, 0x7D, 0xA2,
        0x49, 0xB7, 0x0E, 0xBC, 0xB6, 0x36, 0xAA, 0x32,
        0x05, 0xB0, 0x5E, 0xBD, 0x7C, 0x45, 0x50, 0x03,
        0x2A, 0x54, 0xD9, 0x72, 0x26, 0xA9, 0x13, 0x19,
        0xB4, 0xBB, 0x10, 0x31, 0xAB, 0x59, 0x36, 0x02,
        0x00, 0xE6, 0x7B, 0x0D, 0x8B, 0x38, 0x40, 0x84,
        0x6E, 0x86, 0x0D, 0xEC, 0x38, 0xC7, 0x07, 0x62,
        0x4F, 0xDB, 0xBA, 0xBD, 0xB3, 0x6D, 0x73, 0x8A,
        0x42, 0x80, 0x60, 0x3A, 0x01, 0xDB, 0xC0, 0x11,
        0xA3, 0x27, 0x43, 0xC1, 0xE3, 0x39, 0xA0, 0xE2,
        0xEB, 0xDA, 0x64, 0x4B, 0x86, 0xB5, 0x1C, 0xC2,
        0xBF, 0x1D, 0x91, 0x39, 0xE9, 0xCF, 0xCA, 0xE8,
        0x4C, 0x6B, 0xA2, 0x77, 0xA0, 0x48, 0xDE, 0x28,
        0xA8, 0xA2, 0x86, 0xE0, 0x36, 0x18, 0x9D, 0x1E
    };

    unsigned char r3[] = {
        0x83, 0x68, 0xD8, 0xD8, 0xF6, 0x60, 0x52, 0xA9,
        0x51, 0x4E, 0x34, 0x0E, 0x69, 0x3E, 0x00, 0x97,
        0x58, 0x91, 0xD6, 0x03, 0x4E, 0xFB, 0x77, 0xB6,
        0xCC, 0xA5, 0x8A, 0xF0, 0x54, 0xC8, 0xF0, 0x75,
        0xE5, 0x79, 0x6E, 0x19, 0x2C, 0xA1, 0x62, 0x65,
        0x42, 0xAF, 0x63, 0x81, 0x14, 0x7A, 0xC5, 0xA1,
        0x87, 0xD7, 0x9A, 0x41, 0xA0, 0x68, 0xD8, 0x5E,
        0xE5, 0x29, 0x2F, 0xF8, 0x70, 0x74, 0xFD, 0x37,
        0x26, 0xF0, 0x88, 0xBF, 0xAD, 0x1C, 0xB1, 0x0F,
        0x0A, 0x32, 0xD3, 0xDD, 0x08, 0xFF, 0xF4, 0xBB,
        0x84, 0xCC, 0xEA, 0x3A, 0x5C, 0x18, 0x54, 0xB2,
        0x90, 0xC1, 0xFD, 0xD3, 0xE6, 0x7A, 0xCE, 0x93,
        0x3B, 0xD3, 0x9D, 0xBC, 0xEA, 0x89, 0xFE, 0x33,
        0x71, 0x18, 0xB3, 0xA8, 0xA8, 0x99, 0x10, 0xAE,
        0xF0, 0xD1, 0x32, 0x1D, 0x23, 0x9D, 0xF5, 0xD0,
        0xFF, 0x3B, 0x9C, 0x08, 0x46, 0x7E, 0x3D
    };

    bigint_from_bytes(&a, a3, sizeof(a3));
    bigint_from_bytes(&m, m3, sizeof(m3));
    bigint_from_bytes(&r, r3, sizeof(r3));

    bigint_square_mod(&a, &m, &a);
    res = bigint_cmp(&a, &r);
    if(res == 0){
        bigint_print(&a, "r = ");
        print_passed("bigint_square_mod_test  3 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&m, "m = ");     
        bigint_print(&a, "r = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_square_mod_test  3 - failed");
    }

    bigint_free(&a);
    bigint_free(&r);
    bigint_free(&m);
    bigint_free(&c);

    return failed;
}

int bigint_expt_mod_test(){
    int failed = 0;
    int res = 0;
    bigint a, e, m, c, r;

    unsigned char a1[] = {
        0x45, 0xEB, 0x06, 0x59, 0x52, 0xDC, 0x59, 0x27,
        0xEF, 0x99, 0x86, 0x22, 0x59, 0x9A, 0xF9, 0x72
    };

    unsigned char e1[] = {
        0xE5, 0x30, 0x8F, 0x20, 0x20, 0x4C, 0x48, 0x6F,
        0x36, 0x46, 0xE7, 0xD5, 0x66, 0x40, 0xB3, 0xC2
    };

    unsigned char m1[] = {
        0x6B, 0xE8, 0x2F, 0xA3, 0x69, 0xA4, 0xE3, 0xBD,
        0x15, 0xEB, 0xDD, 0x9C, 0xFE, 0x0C, 0x1A, 0x23
    };

    unsigned char r1[] = {
        0x59, 0xE1, 0x18, 0x6A, 0xCC, 0xB5, 0x6F, 0x87,
        0x6A, 0xE3, 0x1E, 0x0C, 0xEE, 0xBC, 0xCD, 0xA5
    };

    bigint_init(&a, 4);
    bigint_init(&e, 4);
    bigint_init(&c, 4);
    bigint_init(&m, 4);
    bigint_init(&r, 4);
    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&e, e1, 16);
    bigint_from_bytes(&m, m1, 16);
    bigint_from_bytes(&r, r1, 16);

    bigint_expt_mod(&a, &e, &m, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "r = ");
        print_passed("bigint_expt_mod_test  1 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&e, "b = ");     
        bigint_print(&m, "m = ");     
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_expt_mod_test  1 - failed");
    }

    unsigned char a2[] = {
        0x77, 0x23, 0x05, 0x05, 0x66, 0xB7, 0xE8, 0x13,
        0x07, 0xA6, 0xEE, 0x2A, 0x05, 0x86, 0xA6, 0xA7
    };

    unsigned char e2[] = {
        0x2B, 0xF9, 0xE1, 0x86, 0x61, 0x39, 0x62, 0xB0,
        0xE5, 0x2C, 0x27, 0x43, 0xE3, 0xFC, 0xD2, 0xBC
    };

    unsigned char m2[] = {
        0x3A, 0xF4, 0x67, 0x0A, 0x65, 0x4F, 0x5D, 0x47,
        0x22, 0x69, 0xC6, 0xCF, 0xBE, 0x9D, 0x32, 0xA9
    };

    unsigned char r2[] = {
        0x31, 0xFF, 0x13, 0x96, 0xDF, 0x8B, 0x4F, 0x11,
        0xF3, 0x88, 0x2B, 0x89, 0xFE, 0x0F, 0x3A, 0x23
    };

    bigint_from_bytes(&a, a2, 16);
    bigint_from_bytes(&e, e2, 16);
    bigint_from_bytes(&m, m2, 16);
    bigint_from_bytes(&r, r2, 16);

    bigint_expt_mod(&a, &e, &m, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "r = ");
        print_passed("bigint_expt_mod_test  2 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&e, "b = ");     
        bigint_print(&m, "m = ");     
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_expt_mod_test  2 - failed");
    }

    unsigned char a3[] = {
        0x9D, 0xB5, 0x05, 0x76, 0x33, 0xB3, 0x49, 0x6A,
        0xF5, 0x81, 0xF2, 0x9C, 0x4B, 0x53, 0x10, 0x36
    };

    unsigned char e3[] = {
        0x25, 0x1D, 0x91, 0x2F, 0x58, 0x5C, 0x9A, 0x35,
        0x7E, 0xC7, 0x8E, 0x1A, 0xED, 0x8F, 0x81, 0x62,
        0x09, 0x57, 0x24, 0x89, 0x72, 0xDD, 0x44, 0x11,
        0xDE, 0x7D, 0x06, 0x0D, 0xA6, 0x43, 0xF9, 0x0A
    };

    unsigned char m3[] = {
        0x10, 0xF7, 0x33, 0xCA, 0x14, 0xA6, 0xA5, 0xA3,
        0x46, 0xA2, 0x74, 0x8A, 0xEE, 0x8D, 0x88, 0x25
    };

    unsigned char r3[] = {
        0xAF, 0x38, 0x3C, 0xD4, 0xF5, 0xE7, 0xA5, 0x1D,
        0x12, 0x83, 0xC6, 0xEA, 0x07, 0x3D, 0xE9
    };

    bigint_from_bytes(&a, a3, 16);
    bigint_from_bytes(&e, e3, 32);
    bigint_from_bytes(&m, m3, 16);
    bigint_from_bytes(&r, r3, 15);

    bigint_expt_mod(&a, &e, &m, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "r = ");
        print_passed("bigint_expt_mod_test  3 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&e, "b = ");     
        bigint_print(&m, "m = ");     
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_expt_mod_test  3 - failed");
    }

    unsigned char a4[] = {
        0xB7, 0xF3, 0xCB, 0x5B, 0x57, 0xEA, 0x88, 0x54,
        0x01, 0x0D, 0x1D, 0x7F, 0x44, 0x47, 0x4A, 0xFD,
        0xB4, 0x60, 0xD6, 0x13, 0x52, 0x60, 0xDC, 0x12,
        0xFA, 0xB8, 0x4A, 0x90, 0xE4, 0x70, 0x9E, 0x53,
        0xC9, 0x14, 0xA3, 0xB1, 0x4A, 0x96, 0x03, 0x3B,
        0xBC, 0x7A, 0xC0, 0x37, 0x76, 0x1F, 0x47, 0xAB,
        0xA6, 0xC2, 0x66, 0xB8, 0x1C, 0xB7, 0x54, 0x37,
        0xBB, 0x76, 0x85, 0x75, 0xF9, 0x4F, 0x34, 0xE2
    };

    unsigned char e4[] = {
        0x79, 0x24, 0x50, 0x4E, 0x84, 0x2D, 0x6B, 0x9D,
        0x8D, 0x16, 0x67, 0x96, 0x0B, 0x20, 0xBC, 0x75,
        0x89, 0x83, 0xFB, 0x8F, 0xE9, 0x86, 0x0A, 0xFB,
        0x2F, 0x87, 0xE1, 0x61, 0x68, 0x73, 0x17, 0x22
    };

    unsigned char m4[] = {
        0x3D, 0xB7, 0xFC, 0xE3, 0xC6, 0xD1, 0x67, 0x8C,
        0x46, 0x81, 0xFC, 0x2B, 0xF2, 0x9E, 0x3B, 0xFB,
        0xB2, 0xAC, 0x15, 0x7B, 0x90, 0xA8, 0x2B, 0xFB,
        0xF8, 0xED, 0x38, 0xEB, 0xB5, 0xA2, 0x91, 0x8B
    };

    unsigned char r4[] = {
        0x35, 0x66, 0xE1, 0x47, 0x41, 0xB8, 0x24, 0x4A,
        0x7D, 0xE1, 0xD8, 0xBF, 0x0F, 0x62, 0x1E, 0x44,
        0xF5, 0x2C, 0x47, 0x7E, 0x68, 0xCD, 0xA2, 0xE6,
        0x3A, 0xAF, 0x64, 0x2E, 0xFB, 0x59, 0xD9, 0xE4
    };

    bigint_from_bytes(&a, a4, sizeof(a4));
    bigint_from_bytes(&e, e4, sizeof(e4));
    bigint_from_bytes(&m, m4, sizeof(m4));
    bigint_from_bytes(&r, r4, sizeof(r4));

    bigint_expt_mod(&a, &e, &m, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "r = ");
        print_passed("bigint_expt_mod_test  4 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&e, "b = ");     
        bigint_print(&m, "m = ");     
        bigint_print(&c, "c = ");
        bigint_print(&r, "r = ");
        print_failed("bigint_expt_mod_test  4 - failed");
    }

    // this subtest case will take quite a while
    // unsigned char a5[] = {
    //     0x9E, 0x58, 0xE6, 0x44, 0x45, 0x72, 0xDE, 0x34,
    //     0x7F, 0x63, 0x0C, 0x71, 0x14, 0x8B, 0x94, 0x31,
    //     0xEC, 0x32, 0x0B, 0xE0, 0x20, 0x9E, 0x86, 0x05,
    //     0x9B, 0xD5, 0x51, 0xF9, 0x81, 0xCA, 0x15, 0x2E,
    //     0xB2, 0xAB, 0xC8, 0x7A, 0x89, 0x99, 0x37, 0x89,
    //     0xC3, 0x23, 0x9D, 0x53, 0xA5, 0xF4, 0x9E, 0x65,
    //     0x1C, 0x79, 0xDA, 0xDA, 0x5A, 0xC0, 0x33, 0xB0,
    //     0x2B, 0xC8, 0xE0, 0x81, 0x1C, 0x17, 0x7F, 0x94,
    //     0x68, 0xA6, 0x4E, 0xAE, 0x17, 0x3D, 0x4B, 0xAE,
    //     0x70, 0x7C, 0xB4, 0xB9, 0x44, 0x5F, 0x0D, 0x37,
    //     0xE3, 0x9E, 0xE8, 0x8B, 0x82, 0xD9, 0x7D, 0x53,
    //     0xA9, 0x0D, 0xD4, 0xB7, 0xA7, 0x39, 0x57, 0xD5,
    //     0xDB, 0xC3, 0x80, 0xA1, 0x09, 0x98, 0xAB, 0xEA,
    //     0xCC, 0xCE, 0xB6, 0x42, 0xCB, 0x9C, 0xA5, 0x16,
    //     0x57, 0x09, 0x60, 0x8C, 0x14, 0x77, 0xF5, 0x75,
    //     0x09, 0xCC, 0x34, 0x44, 0x35, 0x4B, 0xB6, 0xBD
    // };

    // unsigned char e5[] = {
    //     0xE3, 0x67, 0xA6, 0x4D, 0x06, 0xEF, 0xC6, 0x77,
    //     0xFC, 0x96, 0xC7, 0xB7, 0xAB, 0xA5, 0xB3, 0x51,
    //     0x51, 0x03, 0x05, 0xE8, 0x8C, 0x63, 0xE9, 0x38,
    //     0x69, 0x19, 0x76, 0xE3, 0x08, 0xE0, 0xE6, 0x25,
    //     0xB3, 0xD9, 0x87, 0xCE, 0x86, 0xDA, 0x6F, 0x0C,
    //     0xD6, 0x6A, 0xAA, 0x06, 0x64, 0x60, 0x75, 0x06,
    //     0x0A, 0x5B, 0xE4, 0x58, 0x16, 0xAC, 0x7A, 0xEE,
    //     0x12, 0xE2, 0x04, 0x44, 0x09, 0xD4, 0x87, 0x80
    // };

    // unsigned char m5[] = {
    //     0xBB, 0x38, 0x30, 0x0B, 0x85, 0x35, 0x60, 0x67,
    //     0xBA, 0x4F, 0xD4, 0xDF, 0xD0, 0x18, 0x71, 0x76,
    //     0x59, 0xD3, 0xB9, 0x0D, 0xDE, 0x40, 0xB0, 0xA0,
    //     0xC0, 0xAE, 0x99, 0xC4, 0x6C, 0x38, 0x45, 0x67,
    //     0xDE, 0xF8, 0xB9, 0x04, 0xE2, 0x2F, 0x5D, 0xCE,
    //     0xE7, 0x0A, 0xB2, 0x4B, 0xAC, 0xB1, 0xE8, 0xDA,
    //     0x1B, 0x30, 0x1B, 0x36, 0x93, 0xE8, 0x66, 0x69,
    //     0xC2, 0x60, 0xDB, 0x9D, 0x76, 0x15, 0x55, 0xAF
    // };

    // unsigned char r5[] = {
    //     0xA2, 0xDF, 0x4C, 0x04, 0x50, 0xB5, 0x65, 0x38,
    //     0x59, 0x61, 0x53, 0x25, 0xF8, 0xF2, 0x6F, 0xD4,
    //     0x15, 0x71, 0xB3, 0x97, 0x41, 0x5A, 0x60, 0x49,
    //     0xB2, 0xC3, 0xD5, 0xF8, 0xCA, 0x0B, 0xA1, 0xB1,
    //     0x2E, 0x38, 0x72, 0xB5, 0x6C, 0x2A, 0x1F, 0x1E,
    //     0x8E, 0x2C, 0x5B, 0xEB, 0x97, 0xD0, 0x8D, 0xAC,
    //     0xAD, 0x05, 0xA2, 0x50, 0xF1, 0xED, 0x82, 0x58,
    //     0x4E, 0xC0, 0xDD, 0x66, 0x59, 0x23, 0x36, 0xD3
    // };

    // bigint_from_bytes(&a, a5, sizeof(a5));
    // bigint_from_bytes(&e, e5, sizeof(e5));
    // bigint_from_bytes(&m, m5, sizeof(m5));
    // bigint_from_bytes(&r, r5, sizeof(r5));

    // bigint_expt_mod(&a, &e, &m, &c);
    // res = bigint_cmp(&c, &r);
    // if(res == 0){
    //     bigint_print(&c, "r = ");
    //     print_passed("bigint_expt_mod_test  5 - passed");
    // } else{
    //     failed = 1;
    //     bigint_print(&a, "a = ");
    //     bigint_print(&e, "b = ");     
    //     bigint_print(&m, "m = ");     
    //     bigint_print(&c, "c = ");
    //     bigint_print(&r, "r = ");
    //     print_failed("bigint_expt_mod_test  5 - failed");
    // }

    bigint_free(&a);
    bigint_free(&e);
    bigint_free(&r);
    bigint_free(&m);
    bigint_free(&c);

    return failed;
}

int bigint_gcd_test(){
    int failed = 0;
    int res = 0;
    bigint a, b, c, r;

    unsigned char a1[] = {
        0x2E, 0x61, 0x49, 0x1E, 0xFA, 0x67, 0x44, 0x1B,
        0x0E, 0x38, 0x4B, 0xDD, 0xDC, 0xE6, 0x8F, 0x02
    };

    unsigned char b1[] = {
        0x1F, 0x5B, 0x5A, 0xFC, 0x10, 0x04, 0x97, 0x2C,
        0x90, 0xAF, 0xF5, 0x27, 0x10, 0x5D, 0x5C, 0xD6
    };

    unsigned char r1[] = {
        0x02
    };

    bigint_init(&a, 4);
    bigint_init(&b, 4);
    bigint_init(&c, 4);
    bigint_init(&r, 1);
    bigint_from_bytes(&a, a1, 16);
    bigint_from_bytes(&b, b1, 16);
    bigint_from_bytes(&r, r1, 1);

    bigint_gcd(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_gcd_test  1 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_gcd_test  1 - failed");
    }

    unsigned char a2[] = {
        0x01, 0x9C, 0x7A, 0x1A, 0x35, 0x1D, 0x6A, 0x19,
        0x35, 0xE6, 0x42, 0x7C, 0x40, 0xAB, 0xAC, 0xA7,
        0x65, 0x84, 0x1C, 0xA1, 0xF3, 0x81, 0x67, 0x8E,
        0x4D, 0x2C, 0x97, 0x2A, 0xB9, 0xF0, 0x8F, 0x54,
        0x8E, 0x6C, 0x63, 0xD1, 0xE4, 0x38, 0x2D, 0x12,
        0x38, 0x65, 0xFA, 0x13, 0x7B, 0x09, 0xD7, 0x47,
        0x86, 0x08, 0x09, 0xCA, 0x08, 0xCA, 0x84, 0xE7,
        0xB9, 0xEC, 0xAA, 0xA9, 0x31, 0xE7, 0xB2, 0x6C,
        0xB2, 0xEE
    };

    unsigned char b2[] = {
        0x8F, 0x5E, 0xCA, 0x53, 0x18, 0x15, 0x00, 0x1B,
        0xBF, 0x84, 0x07, 0xCA, 0x91, 0x7D, 0x50, 0x57
    };

    unsigned char r2[] = {
        0x01
    };

    bigint_from_bytes(&a, a2, sizeof(a2));
    bigint_from_bytes(&b, b2, sizeof(b2));
    bigint_from_bytes(&r, r2, 1);

    bigint_gcd(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_gcd_test  2 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_gcd_test  2 - failed");
    }

    unsigned char a3[] = {
        0x2C, 0xE9, 0xB6, 0xF3, 0x65, 0x55, 0xBA, 0x8C,
        0x08, 0x5F, 0x45, 0x44, 0x94, 0x1E, 0x4D, 0x84,
        0x64, 0x6E, 0x95, 0xF7, 0x1D, 0x20, 0x08, 0x15,
        0x35, 0xD1, 0xC2, 0x78, 0x8B, 0xD6, 0xA8, 0xBB,
        0xE8, 0x93, 0x19, 0x3F, 0xD4, 0xA3, 0xB7, 0x34,
        0x59, 0x1D, 0xF7, 0xD6, 0xF8, 0x8D, 0x82, 0x1B,
        0xC3, 0x9B, 0xD7, 0x33, 0x45, 0x05, 0x48, 0x62,
        0x26, 0xB8, 0x2B, 0xC6, 0xA2, 0x69, 0xE6, 0x4C,
        0xBB, 0xFB, 0xA3, 0x1D, 0x19, 0xDF, 0x98, 0x8A,
        0x32, 0x20, 0x60, 0xE3, 0x69, 0xA1, 0xB5, 0x33,
        0xC9, 0x64, 0xA4, 0x7A, 0x1A, 0xFA, 0x48, 0x02,
        0x4F, 0x42, 0x2B, 0x31, 0xD0, 0xA3, 0x3D, 0xF6,
        0xCB, 0xE8, 0x16, 0xD7, 0x0A, 0x05, 0xB0, 0x5A,
        0x53, 0x0E, 0x99, 0xBE, 0x62, 0x37, 0x93, 0x8E,
        0xB5, 0x44, 0x2A, 0x18, 0xCC, 0x5C, 0x2D, 0x82,
        0xCA, 0x2D, 0x58, 0x33, 0x79, 0x3F, 0xE0, 0x25
    };

    unsigned char b3[] = {
        0xBE, 0xC5, 0xA0, 0xDD, 0x9A, 0xF5, 0xA4, 0x3A,
        0xAC, 0x18, 0x86, 0x17, 0x61, 0x63, 0xF8, 0x30,
        0x9D, 0xE7, 0x59, 0x01, 0x87, 0x33, 0x26, 0xAE,
        0x5B, 0xF0, 0xD1, 0x62, 0x34, 0x50, 0xDB, 0x73,
        0x51, 0xCE, 0xC3, 0xB9, 0xAA, 0x42, 0x8C, 0xB2,
        0x80, 0xCB, 0x0A, 0x66, 0x5C, 0xEC, 0xE8, 0x2E,
        0x32, 0x22, 0xFA, 0xD7, 0x96, 0xC1, 0x75, 0xBD,
        0x3E, 0xAD, 0xDD, 0x5D, 0xAB, 0xB1, 0xA1, 0x6B
    };

    unsigned char r3[] = {
        0x03
    };

    bigint_from_bytes(&a, a3, sizeof(a3));
    bigint_from_bytes(&b, b3, sizeof(b3));
    bigint_from_bytes(&r, r3, 1);

    bigint_gcd(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_gcd_test  3 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_gcd_test  3 - failed");
    }

    unsigned char a4[] = {
        0xBE, 0xC5, 0xA0, 0xDD, 0x9A, 0xF5, 0xA4, 0x3A,
        0xAC, 0x18, 0x86, 0x17, 0x61, 0x63, 0xF8, 0x30,
        0x9D, 0xE7, 0x59, 0x01, 0x87, 0x33, 0x26, 0xAE,
        0x5B, 0xF0, 0xD1, 0x62, 0x34, 0x50, 0xDB, 0x73,
        0x51, 0xCE, 0xC3, 0xB9, 0xAA, 0x42, 0x8C, 0xB2,
        0x80, 0xCB, 0x0A, 0x66, 0x5C, 0xEC, 0xE8, 0x2E,
        0x32, 0x22, 0xFA, 0xD7, 0x96, 0xC1, 0x75, 0xBD,
        0x3E, 0xAD, 0xDD, 0x5D, 0xAB, 0xB1, 0xA1, 0x6B
    };

    unsigned char b4[] = {
        0x00
    };

    unsigned char r4[] = {
        0xBE, 0xC5, 0xA0, 0xDD, 0x9A, 0xF5, 0xA4, 0x3A,
        0xAC, 0x18, 0x86, 0x17, 0x61, 0x63, 0xF8, 0x30,
        0x9D, 0xE7, 0x59, 0x01, 0x87, 0x33, 0x26, 0xAE,
        0x5B, 0xF0, 0xD1, 0x62, 0x34, 0x50, 0xDB, 0x73,
        0x51, 0xCE, 0xC3, 0xB9, 0xAA, 0x42, 0x8C, 0xB2,
        0x80, 0xCB, 0x0A, 0x66, 0x5C, 0xEC, 0xE8, 0x2E,
        0x32, 0x22, 0xFA, 0xD7, 0x96, 0xC1, 0x75, 0xBD,
        0x3E, 0xAD, 0xDD, 0x5D, 0xAB, 0xB1, 0xA1, 0x6B
    };

    bigint_from_bytes(&a, a4, sizeof(a4));
    bigint_from_bytes(&b, b4, sizeof(b4));
    bigint_from_bytes(&r, r4, sizeof(r4));
    bigint_gcd(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_gcd_test  4 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_gcd_test  4 - failed");
    }

    unsigned char a5[] = {
        0x00
    };

    unsigned char b5[] = {
        0xBE, 0xC5, 0xA0, 0xDD, 0x9A, 0xF5, 0xA4, 0x3A,
        0xAC, 0x18, 0x86, 0x17, 0x61, 0x63, 0xF8, 0x30,
        0x9D, 0xE7, 0x59, 0x01, 0x87, 0x33, 0x26, 0xAE,
        0x5B, 0xF0, 0xD1, 0x62, 0x34, 0x50, 0xDB, 0x73,
        0x51, 0xCE, 0xC3, 0xB9, 0xAA, 0x42, 0x8C, 0xB2,
        0x80, 0xCB, 0x0A, 0x66, 0x5C, 0xEC, 0xE8, 0x2E,
        0x32, 0x22, 0xFA, 0xD7, 0x96, 0xC1, 0x75, 0xBD,
        0x3E, 0xAD, 0xDD, 0x5D, 0xAB, 0xB1, 0xA1, 0x6B
    };

    unsigned char r5[] = {
        0xBE, 0xC5, 0xA0, 0xDD, 0x9A, 0xF5, 0xA4, 0x3A,
        0xAC, 0x18, 0x86, 0x17, 0x61, 0x63, 0xF8, 0x30,
        0x9D, 0xE7, 0x59, 0x01, 0x87, 0x33, 0x26, 0xAE,
        0x5B, 0xF0, 0xD1, 0x62, 0x34, 0x50, 0xDB, 0x73,
        0x51, 0xCE, 0xC3, 0xB9, 0xAA, 0x42, 0x8C, 0xB2,
        0x80, 0xCB, 0x0A, 0x66, 0x5C, 0xEC, 0xE8, 0x2E,
        0x32, 0x22, 0xFA, 0xD7, 0x96, 0xC1, 0x75, 0xBD,
        0x3E, 0xAD, 0xDD, 0x5D, 0xAB, 0xB1, 0xA1, 0x6B
    };

    bigint_from_bytes(&a, a5, sizeof(a5));
    bigint_from_bytes(&b, b5, sizeof(b5));
    bigint_from_bytes(&r, r5, sizeof(r5));
    bigint_gcd(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_gcd_test  5 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_gcd_test  5 - failed");
    }

    unsigned char a6[] = {
        0xBE, 0xC5, 0xA0, 0xDD, 0x9A, 0xF5, 0xA4, 0x3A,
        0xAC, 0x18, 0x86, 0x17, 0x61, 0x63, 0xF8, 0x30,
        0x9D, 0xE7, 0x59, 0x01, 0x87, 0x33, 0x26, 0xAE,
        0x5B, 0xF0, 0xD1, 0x62, 0x34, 0x50, 0xDB, 0x73,
        0x51, 0xCE, 0xC3, 0xB9, 0xAA, 0x42, 0x8C, 0xB2,
        0x80, 0xCB, 0x0A, 0x66, 0x5C, 0xEC, 0xE8, 0x2E,
        0x32, 0x22, 0xFA, 0xD7, 0x96, 0xC1, 0x75, 0xBD,
        0x3E, 0xAD, 0xDD, 0x5D, 0xAB, 0xB1, 0xA1, 0x6B
    };

    unsigned char b6[] = {
        0xBE, 0xC5, 0xA0, 0xDD, 0x9A, 0xF5, 0xA4, 0x3A,
        0xAC, 0x18, 0x86, 0x17, 0x61, 0x63, 0xF8, 0x30,
        0x9D, 0xE7, 0x59, 0x01, 0x87, 0x33, 0x26, 0xAE,
        0x5B, 0xF0, 0xD1, 0x62, 0x34, 0x50, 0xDB, 0x73,
        0x51, 0xCE, 0xC3, 0xB9, 0xAA, 0x42, 0x8C, 0xB2,
        0x80, 0xCB, 0x0A, 0x66, 0x5C, 0xEC, 0xE8, 0x2E,
        0x32, 0x22, 0xFA, 0xD7, 0x96, 0xC1, 0x75, 0xBD,
        0x3E, 0xAD, 0xDD, 0x5D, 0xAB, 0xB1, 0xA1, 0x6B
    };

    unsigned char r6[] = {
        0xBE, 0xC5, 0xA0, 0xDD, 0x9A, 0xF5, 0xA4, 0x3A,
        0xAC, 0x18, 0x86, 0x17, 0x61, 0x63, 0xF8, 0x30,
        0x9D, 0xE7, 0x59, 0x01, 0x87, 0x33, 0x26, 0xAE,
        0x5B, 0xF0, 0xD1, 0x62, 0x34, 0x50, 0xDB, 0x73,
        0x51, 0xCE, 0xC3, 0xB9, 0xAA, 0x42, 0x8C, 0xB2,
        0x80, 0xCB, 0x0A, 0x66, 0x5C, 0xEC, 0xE8, 0x2E,
        0x32, 0x22, 0xFA, 0xD7, 0x96, 0xC1, 0x75, 0xBD,
        0x3E, 0xAD, 0xDD, 0x5D, 0xAB, 0xB1, 0xA1, 0x6B
    };

    bigint_from_bytes(&a, a6, sizeof(a6));
    bigint_from_bytes(&b, b6, sizeof(b6));
    bigint_from_bytes(&r, r6, sizeof(r6));
    bigint_gcd(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_gcd_test  6 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_gcd_test  6 - failed");
    }

    unsigned char a7[] = {
        0x0F
    };

    unsigned char b7[] = {
        0x03
    };

    unsigned char r7[] = {
        0x03
    };

    bigint_from_bytes(&a, a7, sizeof(a7));
    bigint_from_bytes(&b, b7, sizeof(b7));
    bigint_from_bytes(&r, r7, sizeof(r7));
    bigint_gcd(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_gcd_test  7 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_gcd_test  7 - failed");
    }

    bigint_free(&a);
    bigint_free(&b);
    bigint_free(&c);
    bigint_free(&r);
    return failed;
}

int bigint_lcm_test(){
    int failed = 0;
    int res = 0;
    bigint a, b, c, r;

    unsigned char a1[] = {
        0x6B, 0x30, 0xB5, 0xBE, 0x09, 0x0C, 0xB4, 0xA3,
        0x9F, 0xA3, 0x6B, 0xCC, 0x44, 0x5B, 0x7D, 0xC2
    };

    unsigned char b1[] = {
        0x66, 0xD7, 0x31, 0xD0, 0x02, 0x27, 0xBA, 0xDD,
        0x45, 0x3A, 0x6F, 0xC8, 0xDE, 0xC8, 0xB5, 0x35
    };

    unsigned char r1[] = {
        0x2B, 0x0F, 0x83, 0x2D, 0xC5, 0x78, 0xB7, 0xDC,
        0xE6, 0x07, 0x50, 0x80, 0x5F, 0x39, 0x1B, 0x76,
        0x8D, 0xA2, 0x45, 0xFF, 0x16, 0xA3, 0xF8, 0x38,
        0xCD, 0xDE, 0xD9, 0xB7, 0x52, 0x6B, 0x33, 0x2A
    };

    bigint_init(&a, 1);
    bigint_init(&b, 1);
    bigint_init(&r, 1);
    bigint_init(&c, 1);

    bigint_from_bytes(&a, a1, sizeof(a1));
    bigint_from_bytes(&b, b1, sizeof(b1));
    bigint_from_bytes(&r, r1, sizeof(r1));
    bigint_lcm(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_lcm_test  1 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_lcm_test  1 - failed");
    }

    unsigned char a2[] = {
        0x4B, 0xA6, 0x2A, 0xBA, 0x1D, 0x97, 0xA6, 0x1E,
        0x80, 0x18, 0xED, 0xE2, 0xAC, 0xAC, 0x0F, 0x19
    };

    unsigned char b2[] = {
        0x09, 0xD6, 0x02, 0xDC, 0xAA, 0x68, 0x1E, 0xE1,
        0xD8, 0xAC, 0xC7, 0x9D, 0x32, 0xCF, 0x37, 0x40,
        0x15, 0x4F, 0xEB, 0x51, 0x86
    };

    unsigned char r2[] = {
        0x02, 0xE8, 0x15, 0x40, 0xC4, 0x1C, 0x5A, 0xC9,
        0xB6, 0xF6, 0x4E, 0x0F, 0xFD, 0x32, 0x2B, 0xA7,
        0xD2, 0x6B, 0x5D, 0xE4, 0x05, 0xE2, 0xEE, 0x29,
        0xA5, 0x4A, 0x9A, 0x92, 0x9B, 0xE5, 0xF1, 0x54,
        0xF0, 0x65, 0xC9, 0xD0, 0x16
    };

    bigint_from_bytes(&a, a2, sizeof(a2));
    bigint_from_bytes(&b, b2, sizeof(b2));
    bigint_from_bytes(&r, r2, sizeof(r2));
    bigint_lcm(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_lcm_test  2 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_lcm_test  2 - failed");
    }

    unsigned char a3[] = {
        0xC3, 0x34, 0x97, 0x3C, 0x25, 0x13, 0xC3, 0xA6,
        0xA3, 0x0D, 0x00, 0x23, 0xE0, 0x46, 0xC4, 0xCE,
        0xFE, 0x1E, 0xA0, 0x0F, 0x40, 0x8E, 0xE7, 0x66,
        0xF6, 0x41, 0x7A, 0xEC, 0xA4, 0x15, 0x06, 0xC8,
        0x8F, 0xCE, 0x29, 0xD4, 0xF4, 0x17, 0x91, 0x94,
        0x5F, 0x65, 0xBE, 0x1B, 0xAA, 0xF3, 0x4B, 0x53,
        0xFE, 0x9C, 0xD8, 0x8A, 0x26, 0x08, 0xE3, 0x03,
        0x96, 0xD7, 0x59, 0x79, 0xCF, 0x18, 0x4B, 0x1D
    };

    unsigned char b3[] = {
        0x98, 0xF6, 0x05, 0xEB, 0x68, 0xCF, 0xA9, 0x03,
        0x6E, 0x73, 0x8D, 0x28, 0xA3, 0x06, 0xFF, 0xA4,
        0x8C, 0x24, 0x50, 0x91, 0xF4, 0x9A, 0x83, 0xFF,
        0xE0, 0x35, 0x6B, 0xB6, 0xCA, 0xE5, 0x16, 0x01
    };

    unsigned char r3[] = {
        0x74, 0xA2, 0xD2, 0xD8, 0x91, 0xF6, 0x13, 0xEF,
        0x6D, 0x46, 0x73, 0x9E, 0x7A, 0xB9, 0x83, 0x8F,
        0x54, 0xF1, 0xBF, 0xE0, 0x70, 0xC0, 0xC6, 0xDD,
        0x22, 0x60, 0x9B, 0xA1, 0x87, 0x64, 0x88, 0x51,
        0x5B, 0x1E, 0x62, 0x80, 0x57, 0x46, 0x80, 0x40,
        0x64, 0xD5, 0x65, 0xC2, 0x03, 0xB4, 0xC5, 0xDA,
        0x69, 0x2E, 0xDF, 0x45, 0xE5, 0x0E, 0xCD, 0xB8,
        0x00, 0xBC, 0x44, 0x3A, 0x47, 0x96, 0x35, 0xB7,
        0xC6, 0x3A, 0x5E, 0x3A, 0x18, 0x6F, 0xDB, 0xA0,
        0x14, 0x5D, 0xBC, 0x5F, 0xF5, 0xB1, 0x7D, 0x56,
        0xC4, 0x03, 0x1B, 0x4C, 0xB6, 0xC8, 0x5E, 0x03,
        0x8F, 0x92, 0xC2, 0xE3, 0xF8, 0x7D, 0xC9, 0x1D
    };

    bigint_from_bytes(&a, a3, sizeof(a3));
    bigint_from_bytes(&b, b3, sizeof(b3));
    bigint_from_bytes(&r, r3, sizeof(r3));
    bigint_lcm(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_lcm_test  3 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_lcm_test  3 - failed");
    }

    unsigned char a4[] = {
        0xC6, 0xAC, 0xD6, 0x0F, 0xAF, 0x91, 0x2C, 0x33,
        0xB0, 0x99, 0xFE, 0xD5, 0xDC, 0x00, 0x62, 0xA9,
        0xDE, 0xAA, 0xEC, 0x0E, 0xAE, 0x9A, 0x71, 0x2F,
        0x33, 0x01, 0xCF, 0x38, 0x1C, 0x50, 0x5C, 0x9F,
        0x33, 0x49, 0xA6, 0x60, 0x5D, 0x51, 0xB2, 0x68,
        0xD7, 0xFE, 0x43, 0xBD, 0xD8, 0xA8, 0x65, 0x12,
        0x72, 0xD0, 0xBB, 0xF2, 0x3B, 0x52, 0x65, 0x92,
        0x30, 0x44, 0x3C, 0xB5, 0x62, 0xC2, 0x55, 0x59,
        0x37, 0x68, 0x25, 0xC8, 0x29, 0xD3, 0x37, 0xBE,
        0xC0, 0xE1, 0xA5, 0xB7, 0xC7, 0x4B, 0x12, 0x28,
        0xD3, 0x40, 0xCE, 0x8B, 0x80, 0x79, 0x0E, 0x99,
        0x73, 0xF9, 0xCB, 0x26, 0x6E, 0xCB, 0xEE, 0x8D,
        0xDC, 0xA1, 0x11, 0x00, 0x94, 0xD0, 0xA0, 0xDE,
        0x81, 0xFC, 0x9D, 0x5A, 0x4A, 0x64, 0x3C, 0xB7,
        0x52, 0x2E, 0x53, 0xBA, 0x3D, 0x0C, 0xE6, 0xE9,
        0xE2, 0x21, 0x26, 0x22, 0xF0, 0xE5, 0xD1, 0x9F
    };

    unsigned char b4[] = {
        0x19, 0x6B, 0xD2, 0xC6, 0x46, 0xCB, 0x8E, 0xE5,
        0x74, 0xCA, 0x9D, 0xB6, 0xA1, 0x30, 0x51, 0xCB,
        0xCB, 0x25, 0x89, 0x4C, 0xA0, 0x22, 0x46, 0xB9,
        0x99, 0x06, 0x0E, 0xE7, 0x6E, 0x20, 0xC8, 0xD0,
        0x9E, 0x7F, 0x9B, 0xDF, 0x61, 0xCC, 0x5B, 0x3D,
        0x00, 0x95, 0x86, 0x03, 0x0C, 0xE5, 0xD0, 0xB2,
        0x55, 0x44, 0x0D, 0x92, 0x43, 0x5B, 0x70, 0x19,
        0x26, 0xDB, 0xF8, 0x06, 0x0A, 0x32, 0x92, 0x71,
        0xC1, 0xBB, 0x95, 0xC1, 0x8A, 0xB8, 0xDD, 0xCB,
        0xB5, 0x3E, 0xF8, 0x87, 0x52, 0x6E, 0xCE, 0x45,
        0x9B, 0xAC, 0xEC, 0xAE, 0x89, 0xA1, 0xE7, 0x4F,
        0x8F, 0x3F, 0x89, 0x44, 0xB8, 0xD0, 0x3A, 0xA0,
        0xFC, 0x13, 0xD8, 0x9D, 0xB9, 0xC0, 0xA0, 0x59,
        0x9F, 0x4D, 0x41, 0xE7, 0xD6, 0x36, 0x75, 0x92,
        0x37, 0x84, 0xEA, 0xDE, 0x2B, 0xF3, 0x6F, 0xF7,
        0xDF, 0xC0, 0xBD, 0xF6, 0x70, 0x47, 0x4A, 0x63
    };

    unsigned char r4[] = {
        0x13, 0xBA, 0x8E, 0xB8, 0xA8, 0xEB, 0x39, 0xA1,
        0x60, 0xD2, 0x1A, 0x7D, 0xD1, 0xDC, 0x32, 0x94,
        0x3E, 0xBF, 0xEC, 0x7A, 0x7E, 0x60, 0xFD, 0xFF,
        0x13, 0x69, 0xE7, 0x33, 0xF1, 0x6E, 0xBF, 0x17,
        0x7F, 0xFC, 0x10, 0x5C, 0x65, 0x19, 0xA9, 0xA1,
        0x25, 0x66, 0x6E, 0x87, 0xFA, 0x9B, 0xFC, 0x29,
        0xA8, 0x96, 0x7F, 0x81, 0x2B, 0xB9, 0x39, 0x1F,
        0x6B, 0x2D, 0x54, 0xA9, 0x56, 0xC3, 0xAA, 0x0A,
        0x64, 0x7F, 0xA2, 0x83, 0x4E, 0xD3, 0x7E, 0x63,
        0xF6, 0xD7, 0xAE, 0x6E, 0x72, 0x06, 0x57, 0xEF,
        0xD8, 0x5A, 0xD2, 0xA4, 0x97, 0x7F, 0xF1, 0x48,
        0xC7, 0x0A, 0x93, 0x8F, 0x5A, 0xF9, 0xD9, 0x44,
        0xB6, 0x7F, 0xFB, 0x82, 0xF8, 0xD1, 0x28, 0xE1,
        0xDC, 0xA3, 0x2C, 0x9D, 0xD2, 0x28, 0xD1, 0x3A,
        0x16, 0x07, 0x27, 0x4D, 0x8C, 0xA5, 0xB8, 0x6E,
        0xBA, 0xDB, 0xBF, 0x47, 0x9A, 0x73, 0x8C, 0xDE,
        0x55, 0x9C, 0x9C, 0x43, 0xA1, 0x31, 0xA6, 0xBA,
        0x5A, 0x65, 0xF7, 0x5A, 0x34, 0x62, 0xA3, 0xDA,
        0x5C, 0x01, 0xBA, 0x8A, 0x7E, 0x7F, 0x7B, 0x85,
        0x01, 0x3F, 0x5D, 0xE5, 0xD3, 0xD5, 0x85, 0x31,
        0x78, 0xB8, 0xCB, 0xB2, 0x0B, 0x31, 0x3D, 0x50,
        0xFE, 0x2E, 0x33, 0x2A, 0xB7, 0xDA, 0xF2, 0xD3,
        0xF8, 0xB6, 0x66, 0xE5, 0xD7, 0xD5, 0x48, 0xC2,
        0x82, 0x36, 0x41, 0x3A, 0x64, 0xD9, 0xFF, 0xA9,
        0x52, 0x5D, 0x4C, 0xB8, 0xE2, 0x73, 0xE9, 0x7D,
        0xA3, 0x72, 0x09, 0x5B, 0x00, 0xDE, 0x48, 0x03,
        0xF0, 0x17, 0xFD, 0xB5, 0x4D, 0x7D, 0x5F, 0xD0,
        0x0E, 0x84, 0x3E, 0xF3, 0x24, 0x12, 0x20, 0x51,
        0x08, 0xEE, 0x1A, 0x88, 0x6E, 0x0C, 0xC0, 0x4B,
        0x3A, 0xF7, 0xAF, 0x80, 0x13, 0xA6, 0xBF, 0x47,
        0xD2, 0xC9, 0x28, 0x74, 0x46, 0x26, 0xA0, 0x7D,
        0xC5, 0xC7, 0x06, 0x62, 0x4A, 0x91, 0x06, 0x7D
    };

    bigint_from_bytes(&a, a4, sizeof(a4));
    bigint_from_bytes(&b, b4, sizeof(b4));
    bigint_from_bytes(&r, r4, sizeof(r4));
    bigint_lcm(&a, &b, &c);
    res = bigint_cmp(&c, &r);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_lcm_test  4 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&b, "b = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "exp_r = ");
        print_failed("bigint_lcm_test  4 - failed");
    }

    bigint_free(&a);
    bigint_free(&b);
    bigint_free(&c);
    bigint_free(&r);

    return failed;
}

int bigint_inverse_mod_test(){
    int failed = 0;
    int res = 0;
    bigint a, m, c, r, one;
    bigint_init(&one, 1);
    bigint_from_small_int(&one, 1);

    unsigned char a1[] = {
        0x1B, 0x76, 0xFE, 0x29, 0x04, 0x5C, 0xEE, 0x77,
        0xE5, 0x48, 0x1E, 0xE7, 0x85, 0x5C, 0xF3, 0xF5
    };

    unsigned char m1[] = {
        0xD3, 0x6A, 0x61, 0xA1, 0xE4, 0xC6, 0x6D, 0x4E,
        0x60, 0xCB, 0x72, 0xFF, 0x02, 0xF3, 0x18, 0x5A
    };

    unsigned char r1[] = {
        0xBB, 0xD7, 0x2F, 0x47, 0x64, 0xA5, 0x79, 0x21,
        0x83, 0x69, 0x6C, 0x3E, 0x9C, 0x05, 0x5B, 0x55
    };

    bigint_init(&a, 1);
    bigint_init(&m, 1);
    bigint_init(&r, 1);
    bigint_init(&c, 1);

    bigint_from_bytes(&a, a1, sizeof(a1));
    bigint_from_bytes(&m, m1, sizeof(m1));
    bigint_from_bytes(&r, r1, sizeof(r1));

    bigint_mul_mod(&a, &r, &m, &c);
    bigint_print(&c, "test case sanity check: r * a (mod m) = ");

    bigint_inverse_mod(&a, &m, &c);
    bigint_mul_mod(&a, &c, &m, &r);
    bigint_print(&r, "r = a * c (mod m) = ");
    res = bigint_cmp(&r, &one);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_inverse_mod_test  1 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&m, "m = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "a * c (mod m) = ");
        print_failed("bigint_inverse_mod_test  1 - failed");
    }

    unsigned char a2[] = {
        0x27, 0x09, 0x8E, 0x77, 0x7C, 0x0B, 0x5E, 0xC1,
        0xAB, 0xAB, 0x01, 0x3A, 0x96, 0xE0, 0xA9, 0x35,
        0x1A, 0xA4, 0xD0, 0x91, 0xE7, 0xE8, 0xBC, 0x65,
        0xD1, 0x5F, 0x96, 0xFD, 0xA5, 0xF3, 0x7E, 0x38
    };

    unsigned char m2[] = {
        0x9F, 0xA7, 0x9A, 0x92, 0x18, 0x86, 0xD9, 0x4F,
        0x37, 0x56, 0x15, 0xB3, 0xD9, 0xDD, 0xDE, 0x94,
        0x47, 0x45, 0x95, 0x18, 0x54, 0x0A, 0x32, 0x01,
        0xB6, 0x96, 0xA6, 0xC0, 0x32, 0xF3, 0x4A, 0x9B
    };

    unsigned char r2[] = {
        0x86, 0xE0, 0x33, 0xD5, 0x02, 0x63, 0x44, 0x91,
        0x46, 0x5A, 0xCC, 0x76, 0x6B, 0xFD, 0xC7, 0x6D,
        0x59, 0xE7, 0x76, 0x2D, 0x70, 0xDD, 0x81, 0x4D,
        0x10, 0x5C, 0x2E, 0x5F, 0xBF, 0xD4, 0x3D, 0x9F
    };

    bigint_from_bytes(&a, a2, sizeof(a2));
    bigint_from_bytes(&m, m2, sizeof(m2));
    bigint_from_bytes(&r, r2, sizeof(r2));

    bigint_mul_mod(&a, &r, &m, &c);
    bigint_print(&c, "test case sanity check: r * a (mod m) = ");

    bigint_inverse_mod(&a, &m, &c);
    bigint_mul_mod(&a, &c, &m, &r);
    bigint_print(&r, "r = a * c (mod m) = ");
    res = bigint_cmp(&r, &one);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_inverse_mod_test  2 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&m, "m = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "a * c (mod m) = ");
        print_failed("bigint_inverse_mod_test  2 - failed");
    }
    
    unsigned char a3[] = {
        0x43, 0x18, 0x86, 0x7B, 0x41, 0xB4, 0xA4, 0xFB,
        0x3B, 0x83, 0xDB, 0x11, 0xE8, 0x75, 0x58, 0x45,
        0xA5, 0x6E, 0xD7, 0x03, 0x6B, 0x92, 0x95, 0x5B,
        0x6C, 0x90, 0xF2, 0x3D, 0x7E, 0x9B, 0x09, 0x83
    };

    unsigned char m3[] = {
        0x7B, 0x84, 0x49, 0x5D, 0x67, 0x89, 0xB0, 0x39,
        0x17, 0x46, 0x6B, 0x73, 0x3B, 0xDF, 0x7D, 0x78
    };

    unsigned char r3[] = {
        0x21, 0xAF, 0x71, 0xEB, 0xE4, 0x01, 0xC5, 0x0D,
        0xC3, 0xAD, 0x73, 0x76, 0x13, 0x5A, 0xC1, 0x23
    };

    bigint_from_bytes(&a, a3, sizeof(a3));
    bigint_from_bytes(&m, m3, sizeof(m3));
    bigint_from_bytes(&r, r3, sizeof(r3));

    bigint_mul_mod(&a, &r, &m, &c);
    bigint_print(&c, "test case sanity check: r * a (mod m) = ");

    bigint_inverse_mod(&a, &m, &c);
    bigint_mul_mod(&a, &c, &m, &r);
    bigint_print(&r, "r = a * c (mod m) = ");
    res = bigint_cmp(&r, &one);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_inverse_mod_test  3 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&m, "m = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "a * c (mod m) = ");
        print_failed("bigint_inverse_mod_test  3 - failed");
    }

    unsigned char a4[] = {
        0x0E, 0x3E, 0xD1, 0x21, 0xB9, 0x07, 0xAD, 0xC9,
        0xFE, 0x67, 0x84, 0xA6, 0x3A, 0xEA, 0x79, 0xB9,
        0x60, 0x3C, 0xBA, 0xA9, 0x8C, 0xEF, 0x5E, 0xFD,
        0xAF, 0x08, 0x48, 0xE1, 0x66, 0x91, 0x75, 0xC8,
        0x4A, 0xF8, 0x67, 0x96, 0x31, 0x36, 0x0B, 0x53,
        0xAA, 0x3E, 0x93, 0x7A, 0x4E, 0x5D, 0x00, 0x1E,
        0x74, 0x62, 0x8E, 0x88, 0x78, 0xB6, 0x13, 0xE4,
        0x9D, 0x2B, 0x7E, 0x04, 0x9A, 0x36, 0x68, 0x85,
        0x61, 0x23, 0x97, 0x8E, 0x9F, 0xDA, 0x84, 0x21,
        0xCC, 0xEA, 0x95, 0xAD, 0x81, 0xD6, 0x93, 0x42,
        0xB1, 0x38, 0xDC, 0x6E, 0x01, 0x2B, 0xFB, 0xAD,
        0x0D, 0x81, 0xA6, 0x0F, 0x73, 0xD2, 0x05, 0x4A,
        0x7B, 0xBA, 0x19, 0x37, 0x3A, 0xC2, 0x55, 0xB8,
        0x69, 0xFC, 0xB5, 0xBE, 0x88, 0x8F, 0xB2, 0xDF,
        0xFF, 0x6C, 0x64, 0xD2, 0xC0, 0xFE, 0xF1, 0xE3,
        0x02, 0xCF, 0x43, 0x3E, 0x8A, 0x5D, 0x2A, 0x50,
        0x9C, 0xA8, 0x61, 0xE9, 0xF2, 0xDE, 0x01, 0x53,
        0x6F, 0x40, 0xAA, 0x40, 0x45, 0x22, 0x0E, 0x7B,
        0x5A, 0x34, 0x4B, 0x67, 0x3F, 0x1B, 0xDD, 0xB3,
        0x29, 0x3D, 0x0C, 0x0E, 0xE0, 0xE6, 0x09, 0x79,
        0xDD, 0x56, 0x32, 0x8C, 0x03, 0xC3, 0x72, 0x03,
        0x44, 0x1C, 0xE7, 0x57, 0xDC, 0xDE, 0x82, 0x7A,
        0xD6, 0x74, 0x7B, 0xE2, 0x76, 0x64, 0x73, 0xBC,
        0x76, 0x1D, 0xD7, 0x45, 0xA1, 0x59, 0x9F, 0xD5,
        0xDE, 0x40, 0x34, 0xEF, 0xC7, 0x7E, 0x0D, 0x19,
        0x06, 0xAE, 0x99, 0x04, 0x16, 0xAD, 0xA6, 0x58,
        0x61, 0xA1, 0x8A, 0x6E, 0x4D, 0x56, 0x8F, 0x75,
        0xB4, 0x4B, 0x64, 0x42, 0xFD, 0x90, 0x14, 0xCD,
        0xD8, 0x6B, 0x58, 0x45, 0xAD, 0x20, 0xF8, 0x61,
        0x67, 0x18, 0x41, 0x7F, 0xE8, 0xA8, 0xDB, 0xD9,
        0xDB, 0xCE, 0x00, 0x5E, 0x0B, 0xF5, 0x46, 0x8B,
        0x5E, 0xB3, 0x45, 0x7A, 0x16, 0x1E, 0x63, 0x77
    };

    unsigned char m4[] = {
        0x38, 0x39, 0xD0, 0x23, 0xCF, 0x03, 0xCD, 0x77,
        0xFC, 0xBC, 0xE6, 0xF9, 0x1B, 0x07, 0x90, 0x43,
        0xDF, 0xAB, 0x82, 0x5D, 0xCA, 0x2B, 0x2F, 0x25,
        0x9F, 0xD7, 0x53, 0xCA, 0x30, 0x34, 0xB8, 0x1E,
        0xA5, 0x68, 0xF9, 0x27, 0x24, 0x64, 0x7D, 0xF1,
        0x0A, 0xE6, 0xAF, 0x2A, 0xDA, 0xE5, 0x37, 0xAE,
        0xFC, 0x98, 0x2C, 0x9F, 0x22, 0xBD, 0xC5, 0xDE,
        0x7D, 0xAA, 0x4C, 0xE8, 0x49, 0xFE, 0x17, 0x75,
        0x2D, 0x3F, 0x0D, 0x28, 0x81, 0xB1, 0x3E, 0x5A,
        0xA1, 0x94, 0x08, 0xBC, 0xCE, 0x17, 0xBD, 0xF7,
        0x66, 0x2E, 0x90, 0x94, 0xF4, 0x40, 0x26, 0x1F,
        0x87, 0xD3, 0x04, 0x44, 0xBD, 0x14, 0x44, 0x67,
        0xBB, 0xFB, 0xB4, 0xEC, 0xC9, 0x43, 0xA0, 0xE0,
        0x63, 0x3F, 0xF5, 0x87, 0x21, 0xBC, 0xF8, 0x65,
        0xFE, 0x19, 0x9A, 0xB1, 0xEA, 0x70, 0xE2, 0xC5,
        0x1D, 0xDA, 0x67, 0x60, 0xD7, 0x36, 0x6B, 0x2A
    };

    unsigned char r4[] = {
        0x23, 0xF8, 0x9A, 0x58, 0x9E, 0x92, 0x1D, 0x29,
        0xC8, 0xC5, 0x4C, 0xBF, 0xD0, 0xCC, 0x68, 0x7E,
        0xD3, 0x94, 0xAA, 0x90, 0x6A, 0xB6, 0x7E, 0x4E,
        0x32, 0x4C, 0x2D, 0x66, 0xB7, 0x23, 0x48, 0x38,
        0xF5, 0x35, 0xBC, 0xDB, 0xC0, 0xAF, 0x2A, 0xAD,
        0x21, 0x2F, 0x09, 0xF1, 0x8E, 0x89, 0x0E, 0xD5,
        0x61, 0x6E, 0xD2, 0xE4, 0x8A, 0x17, 0xAD, 0x9E,
        0x4B, 0x50, 0xC1, 0x83, 0x90, 0xE1, 0x83, 0x83,
        0x0A, 0x3D, 0x1A, 0x17, 0x42, 0xF4, 0x65, 0xE6,
        0x62, 0xA5, 0xAB, 0xEA, 0xF5, 0xB4, 0x33, 0x35,
        0x8F, 0x1F, 0xE1, 0x8E, 0x49, 0x8B, 0xDC, 0xAF,
        0x21, 0xF3, 0x21, 0xB8, 0xC3, 0xA0, 0xA4, 0x67,
        0x4D, 0x55, 0xEE, 0x5A, 0xD8, 0x4A, 0xD0, 0x96,
        0x52, 0x62, 0xDC, 0xBC, 0xBB, 0x89, 0xAA, 0xCC,
        0xAC, 0xED, 0x20, 0x94, 0xFD, 0xD9, 0xC4, 0xA0,
        0xE9, 0x3C, 0xD9, 0x1A, 0xB1, 0x3F, 0x53, 0x6F
    };

    bigint_from_bytes(&a, a4, sizeof(a4));
    bigint_from_bytes(&m, m4, sizeof(m4));
    bigint_from_bytes(&r, r4, sizeof(r4));

    bigint_mul_mod(&a, &r, &m, &c);
    bigint_print(&c, "test case sanity check: r * a (mod m) = ");

    bigint_inverse_mod(&a, &m, &c);
    bigint_mul_mod(&a, &c, &m, &r);
    bigint_print(&r, "r = a * c (mod m) = ");
    res = bigint_cmp(&r, &one);
    if(res == 0){
        bigint_print(&c, "c = ");
        print_passed("bigint_inverse_mod_test  4 - passed");
    } else{
        failed = 1;
        bigint_print(&a, "a = ");
        bigint_print(&m, "m = ");
        bigint_print(&c, "c = ");
        bigint_print(&r, "a * c (mod m) = ");
        print_failed("bigint_inverse_mod_test  4 - failed");
    }

    bigint_free(&a);
    bigint_free(&m);
    bigint_free(&c);
    bigint_free(&r);
    bigint_free(&one);
    return failed;
}